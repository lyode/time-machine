<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mystical Oracle - Messages from the Universe</title>
    <meta name="theme-color" content="#1a1a2e">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        html {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
            overflow: hidden;
            position: fixed;
            -webkit-text-size-adjust: 100%;
            -ms-text-size-adjust: 100%;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: radial-gradient(ellipse at center, var(--bg-primary) 0%, var(--bg-secondary) 30%, var(--bg-tertiary) 100%);
            width: 100vw;
            height: 100vh;
            height: 100dvh;
            color: white;
            overflow: hidden;
            position: fixed;
            top: 0;
            left: 0;
            margin: 0;
            padding: 0;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            --bg-primary: #1a1a2e;
            --bg-secondary: #16213e;
            --bg-tertiary: #0f1419;
            --accent-primary: rgba(186, 85, 211, 0.8);
            --accent-secondary: rgba(138, 43, 226, 0.7);
            --accent-tertiary: rgba(147, 112, 219, 0.6);
            --glow-intensity: 1;
            transition: all 0.3s ease;
        }

        /* Dynamic Theme System */
        body.theme-cosmic {
            --bg-primary: #1a1a2e;
            --bg-secondary: #16213e;
            --bg-tertiary: #0f1419;
            --accent-primary: rgba(186, 85, 211, 0.8);
            --accent-secondary: rgba(138, 43, 226, 0.7);
            --accent-tertiary: rgba(147, 112, 219, 0.6);
        }

        body.theme-ethereal {
            --bg-primary: #0f1419;
            --bg-secondary: #1a2b3e;
            --bg-tertiary: #0a0f1a;
            --accent-primary: rgba(100, 200, 255, 0.8);
            --accent-secondary: rgba(50, 150, 255, 0.7);
            --accent-tertiary: rgba(150, 220, 255, 0.6);
        }

        body.theme-mystical {
            --bg-primary: #2e1a1a;
            --bg-secondary: #3e1621;
            --bg-tertiary: #190f14;
            --accent-primary: rgba(255, 100, 150, 0.8);
            --accent-secondary: rgba(200, 50, 100, 0.7);
            --accent-tertiary: rgba(255, 150, 200, 0.6);
        }

        body.theme-aurora {
            --bg-primary: #1a2e1a;
            --bg-secondary: #213e16;
            --bg-tertiary: #14190f;
            --accent-primary: rgba(100, 255, 150, 0.8);
            --accent-secondary: rgba(50, 200, 100, 0.7);
            --accent-tertiary: rgba(150, 255, 200, 0.6);
        }

        /* Advanced Controls */
        .control-panel {
            position: fixed;
            top: 5px;
            right: 5px;
            z-index: 3000;
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .control-row {
            display: flex;
            gap: 5px;
            background: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(20px);
            border: 1px solid var(--accent-primary);
            border-radius: 12px;
            padding: 4px;
        }

        .control-btn {
            background: var(--accent-primary);
            border: 1px solid var(--accent-secondary);
            color: #e8e8e8;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 0.6rem;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 24px;
            text-align: center;
            backdrop-filter: blur(10px);
        }

        .control-btn:hover, .control-btn.active {
            background: var(--accent-secondary);
            transform: translateY(-1px);
            box-shadow: 0 2px 8px var(--accent-primary);
        }

        /* Main Oracle Container */
        .oracle-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            height: 100dvh;
            background: radial-gradient(ellipse at center, var(--bg-primary) 0%, var(--bg-secondary) 30%, var(--bg-tertiary) 100%);
            overflow: hidden;
            z-index: 1000;
            margin: 0;
            padding: 0;
            border: none;
        }

        .oracle-background {
            position: absolute;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }

        /* Enhanced Black Hole with Physics */
        .black-hole-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80vmin;
            height: 80vmin;
            z-index: 1001;
            transition: all 0.5s ease;
        }

        .black-hole-container.expanded {
            width: 95vmin;
            height: 95vmin;
        }

        .black-hole {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: 
                radial-gradient(circle at center, 
                    transparent 25%, 
                    rgba(0, 0, 0, 0.1) 30%, 
                    rgba(0, 0, 0, 0.6) 45%, 
                    rgba(0, 0, 0, 0.9) 55%, 
                    black 65%);
            box-shadow: 
                inset 0 0 50px var(--accent-primary),
                inset 0 0 100px var(--accent-secondary),
                0 0 100px rgba(0, 0, 0, 0.8);
            animation: blackHoleSwirl 8s linear infinite;
            position: relative;
            overflow: hidden;
            filter: brightness(var(--glow-intensity));
        }

        .black-hole::before {
            content: '';
            position: absolute;
            top: 5%;
            left: 5%;
            width: 90%;
            height: 90%;
            border-radius: 50%;
            background: radial-gradient(circle, var(--accent-primary) 0%, transparent 60%);
            animation: accretionDisk 6s linear infinite reverse;
        }

        .black-hole::after {
            content: '';
            position: absolute;
            top: 10%;
            left: 10%;
            width: 80%;
            height: 80%;
            border-radius: 50%;
            background: radial-gradient(circle, var(--accent-secondary) 0%, transparent 40%);
            animation: accretionDisk 4s linear infinite;
            opacity: 0.7;
        }

        @keyframes blackHoleSwirl {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        @keyframes accretionDisk {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* Advanced Sound Wave System */
        .sound-wave-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1002;
        }

        .sound-wave {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            border: 2px solid var(--accent-primary);
            border-radius: 50%;
            opacity: 0;
            animation: soundWavePulse 2s ease-out infinite;
            transition: all 0.1s ease-out;
        }

        .sound-wave.active {
            opacity: 1;
        }

        .sound-wave.resonance {
            animation: resonanceWave 1.5s ease-in-out infinite;
        }

        .sound-wave.harmonic {
            animation: harmonicWave 3s ease-in-out infinite;
        }

        .sound-wave:nth-child(1) {
            width: 50%;
            height: 50%;
            animation-delay: 0s;
            border-color: var(--accent-primary);
        }

        .sound-wave:nth-child(2) {
            width: 65%;
            height: 65%;
            animation-delay: 0.15s;
            border-color: var(--accent-secondary);
        }

        .sound-wave:nth-child(3) {
            width: 80%;
            height: 80%;
            animation-delay: 0.3s;
            border-color: var(--accent-tertiary);
        }

        .sound-wave:nth-child(4) {
            width: 95%;
            height: 95%;
            animation-delay: 0.45s;
            border-color: var(--accent-primary);
        }

        @keyframes soundWavePulse {
            0% {
                transform: translate(-50%, -50%) scale(0.7);
                opacity: 0;
                border-width: 3px;
            }
            30% {
                opacity: 0.9;
                border-width: 2px;
            }
            70% {
                opacity: 0.6;
                border-width: 1px;
            }
            100% {
                transform: translate(-50%, -50%) scale(1.3);
                opacity: 0;
                border-width: 1px;
            }
        }

        @keyframes resonanceWave {
            0%, 100% {
                transform: translate(-50%, -50%) scale(1);
                opacity: 0.6;
                border-width: 2px;
            }
            50% {
                transform: translate(-50%, -50%) scale(1.1);
                opacity: 1;
                border-width: 3px;
            }
        }

        @keyframes harmonicWave {
            0%, 100% {
                transform: translate(-50%, -50%) scale(0.8) rotate(0deg);
                opacity: 0.4;
            }
            50% {
                transform: translate(-50%, -50%) scale(1.2) rotate(180deg);
                opacity: 0.8;
            }
        }

        /* Enhanced Particle System */
        .mystical-particles {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .mystical-particle {
            position: absolute;
            border-radius: 50%;
            animation: mysticalFloat 8s ease-in-out infinite;
            filter: blur(0.5px);
            transition: all 0.3s ease;
        }

        .mystical-particle.gravitational {
            animation: gravitationalPull 12s ease-in-out infinite;
        }

        .mystical-particle.orbiting {
            animation: orbitBlackHole 15s linear infinite;
        }

        @keyframes mysticalFloat {
            0%, 100% {
                transform: translateY(100vh) scale(0) rotate(0deg);
                opacity: 0;
            }
            5% {
                opacity: 0.8;
                transform: translateY(95vh) scale(1) rotate(45deg);
            }
            95% {
                opacity: 0.8;
                transform: translateY(-5vh) scale(0.8) rotate(315deg);
            }
            100% {
                transform: translateY(-10vh) scale(0) rotate(360deg);
                opacity: 0;
            }
        }

        @keyframes gravitationalPull {
            0% {
                transform: translateY(100vh) translateX(0) scale(0) rotate(0deg);
                opacity: 0;
            }
            20% {
                opacity: 0.8;
                transform: translateY(80vh) translateX(10px) scale(1) rotate(90deg);
            }
            80% {
                opacity: 0.6;
                transform: translateY(20vh) translateX(-20px) scale(0.5) rotate(270deg);
            }
            100% {
                transform: translateY(50vh) translateX(0) scale(0) rotate(360deg);
                opacity: 0;
            }
        }

        @keyframes orbitBlackHole {
            0% {
                transform: rotate(0deg) translateX(40vmin) rotate(0deg);
                opacity: 0.3;
            }
            50% {
                opacity: 0.8;
            }
            100% {
                transform: rotate(360deg) translateX(40vmin) rotate(-360deg);
                opacity: 0.3;
            }
        }

        /* Dynamic Aurora System */
        .aurora-lights {
            position: absolute;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(ellipse at 15% 60%, var(--accent-primary) 0%, transparent 50%),
                radial-gradient(ellipse at 85% 30%, var(--accent-secondary) 0%, transparent 50%),
                radial-gradient(ellipse at 50% 80%, var(--accent-tertiary) 0%, transparent 50%),
                radial-gradient(ellipse at 30% 20%, var(--accent-primary) 0%, transparent 50%);
            animation: auroraShift 15s ease-in-out infinite;
            filter: brightness(var(--glow-intensity));
        }

        @keyframes auroraShift {
            0%, 100% { 
                opacity: 0.7; 
                transform: scale(1) rotate(0deg);
                filter: hue-rotate(0deg) brightness(var(--glow-intensity));
            }
            25% { 
                opacity: 0.9; 
                transform: scale(1.05) rotate(1deg);
                filter: hue-rotate(15deg) brightness(calc(var(--glow-intensity) * 1.2));
            }
            50% { 
                opacity: 0.5; 
                transform: scale(0.98) rotate(-1deg);
                filter: hue-rotate(30deg) brightness(calc(var(--glow-intensity) * 0.8));
            }
            75% { 
                opacity: 0.8; 
                transform: scale(1.02) rotate(0.5deg);
                filter: hue-rotate(15deg) brightness(var(--glow-intensity));
            }
        }

        /* Oracle Landing Screen */
        .oracle-landing {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            opacity: 1;
            transition: all 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            animation: landingBreathe 6s ease-in-out infinite;
            z-index: 2000;
        }

        .oracle-landing.hidden {
            opacity: 0;
            visibility: hidden;
            transform: translate(-50%, -50%) scale(0.85);
        }

        @keyframes landingBreathe {
            0%, 100% { transform: translate(-50%, -50%) scale(1); }
            50% { transform: translate(-50%, -50%) scale(1.02); }
        }

        .floating-ask {
            position: relative;
            cursor: pointer;
            margin-bottom: 30px;
            animation: gentleFloat 4s ease-in-out infinite;
        }

        .floating-ask.activated {
            animation: askActivated 0.5s ease-out;
        }

        @keyframes askActivated {
            0% { transform: translateY(0) scale(1); }
            50% { transform: translateY(-20px) scale(1.1); }
            100% { transform: translateY(0) scale(1); }
        }

        .ask-text {
            font-size: 3.5rem;
            font-weight: 300;
            color: #e8e8e8;
            text-shadow: 0 0 30px var(--accent-primary);
            letter-spacing: 6px;
            position: relative;
            z-index: 1;
            font-family: 'Georgia', serif;
            font-style: italic;
            transition: all 0.3s ease;
        }

        .ask-glow {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 180px;
            height: 180px;
            border-radius: 50%;
            animation: pulseGlow 4s ease-in-out infinite, colorShift 8s ease-in-out infinite;
        }

        @keyframes gentleFloat {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-12px); }
        }

        @keyframes pulseGlow {
            0%, 100% { transform: translate(-50%, -50%) scale(1); opacity: 0.6; }
            50% { transform: translate(-50%, -50%) scale(1.2); opacity: 1; }
        }

        @keyframes colorShift {
            0%, 100% { 
                background: radial-gradient(circle, var(--accent-primary) 0%, transparent 70%);
            }
            25% { 
                background: radial-gradient(circle, var(--accent-secondary) 0%, transparent 70%);
            }
            50% { 
                background: radial-gradient(circle, var(--accent-tertiary) 0%, transparent 70%);
            }
            75% { 
                background: radial-gradient(circle, var(--accent-primary) 0%, transparent 70%);
            }
        }

        .oracle-subtitle {
            font-size: 1rem;
            color: rgba(255, 255, 255, 0.7);
            font-style: italic;
            animation: fadeIn 2s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 0.7; }
        }

        /* Enhanced Floating Words */
        .floating-words-container {
            position: absolute;
            width: 100%;
            height: 100%;
            opacity: 0;
            visibility: hidden;
            transition: all 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            z-index: 2000;
        }

        .floating-words-container.active {
            opacity: 1;
            visibility: visible;
        }

        .floating-words {
            position: relative;
            width: 100%;
            height: 100%;
        }

        .floating-word {
            position: absolute;
            color: #e8e8e8;
            cursor: pointer;
            font-family: 'Georgia', serif;
            font-style: italic;
            text-shadow: 0 0 20px var(--accent-primary);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            animation: wordFloat 8s ease-in-out infinite;
            opacity: 0;
            user-select: none;
            transform-origin: center;
        }

        .floating-word.big {
            font-size: 2.2rem;
            font-weight: 500;
            letter-spacing: 1.5px;
        }

        .floating-word.medium {
            font-size: 1.8rem;
            font-weight: 400;
            letter-spacing: 1px;
        }

        .floating-word.small {
            font-size: 1.3rem;
            font-weight: 300;
            letter-spacing: 0.5px;
        }

        .floating-word:hover {
            transform: scale(1.2) rotate(1deg);
            text-shadow: 
                0 0 25px var(--accent-primary),
                0 0 50px var(--accent-secondary),
                0 0 75px var(--accent-tertiary);
            color: #dda0dd;
            animation-play-state: paused;
        }

        .floating-word:active {
            transform: scale(1.1) rotate(-1deg);
            transition: transform 0.1s ease;
        }

        .floating-word.selected {
            animation: wordSelected 0.6s ease-out;
        }

        @keyframes wordSelected {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.5); opacity: 0.5; }
            100% { transform: scale(0); opacity: 0; }
        }

        @keyframes wordFloat {
            0% {
                opacity: 0;
                transform: translateY(30px) scale(0.7) rotate(-5deg);
                filter: blur(2px);
            }
            15% {
                opacity: 1;
                transform: translateY(0px) scale(1) rotate(0deg);
                filter: blur(0px);
            }
            85% {
                opacity: 1;
                transform: translateY(-15px) scale(1.05) rotate(2deg);
                filter: blur(0px);
            }
            100% {
                opacity: 0;
                transform: translateY(-40px) scale(0.8) rotate(5deg);
                filter: blur(1px);
            }
        }

        /* Enhanced Message Display */
        .message-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 95%;
            max-width: 600px;
            text-align: center;
            opacity: 0;
            visibility: hidden;
            transition: all 1s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            z-index: 2000;
            padding: 0 10px;
        }

        .message-container.active {
            opacity: 1;
            visibility: visible;
        }

        .bright-message {
            background: 
                radial-gradient(circle at 30% 30%, var(--accent-primary) 0%, transparent 50%),
                rgba(255, 255, 255, 0.03);
            border: 2px solid var(--accent-primary);
            border-radius: 20px;
            padding: 30px 25px;
            margin-bottom: 25px;
            backdrop-filter: blur(20px);
            animation: messageFloatUp 2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            position: relative;
            overflow: hidden;
        }

        .bright-message::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, var(--accent-primary), transparent);
            animation: shimmerMessage 6s ease-in-out infinite;
            opacity: 0.1;
        }

        .bright-message p {
            font-size: 1.2rem;
            line-height: 1.7;
            color: #f0f0f0;
            font-family: 'Georgia', serif;
            font-style: italic;
            margin: 0;
            text-shadow: 0 0 20px var(--accent-primary);
            position: relative;
            z-index: 1;
            letter-spacing: 0.3px;
        }

        @keyframes messageFloatUp {
            0% {
                opacity: 0;
                transform: translateY(50px) scale(0.85);
                filter: blur(3px);
            }
            50% {
                opacity: 0.8;
                transform: translateY(-5px) scale(1.02);
                filter: blur(1px);
            }
            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
                filter: blur(0px);
            }
        }

        @keyframes shimmerMessage {
            0%, 100% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            50% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }

        .message-actions {
            display: flex;
            justify-content: center;
            gap: 15px;
            animation: actionsAppear 2.5s cubic-bezier(0.25, 0.46, 0.45, 0.94) 1s both;
            flex-direction: column;
            align-items: center;
        }

        @keyframes actionsAppear {
            0% {
                opacity: 0;
                transform: translateY(20px) scale(0.8);
            }
            60% {
                opacity: 0.8;
                transform: translateY(-3px) scale(1.05);
            }
            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .oracle-button {
            background: var(--accent-primary);
            border: 2px solid var(--accent-secondary);
            color: #f0f0f0;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 1.1rem;
            font-family: 'Georgia', serif;
            font-style: italic;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            backdrop-filter: blur(15px);
            position: relative;
            overflow: hidden;
            letter-spacing: 0.8px;
            font-weight: 400;
            width: 200px;
            text-align: center;
        }

        .oracle-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.6s;
        }

        .oracle-button:hover::before {
            left: 100%;
        }

        .oracle-button:hover {
            background: var(--accent-secondary);
            border-color: var(--accent-tertiary);
            transform: translateY(-2px) scale(1.03);
            box-shadow: 
                0 10px 25px var(--accent-primary),
                0 0 20px var(--accent-secondary);
            text-shadow: 0 0 12px var(--accent-primary);
        }

        .oracle-button:active {
            transform: translateY(-1px) scale(1.01);
            transition: transform 0.1s ease;
        }

        .noted-btn {
            background: rgba(46, 204, 113, 0.8);
            border-color: rgba(46, 204, 113, 0.6);
        }

        .noted-btn:hover {
            background: rgba(46, 204, 113, 1);
            border-color: rgba(46, 204, 113, 0.9);
            box-shadow: 
                0 10px 25px rgba(46, 204, 113, 0.4),
                0 0 20px rgba(46, 204, 113, 0.3);
            text-shadow: 0 0 12px rgba(46, 204, 113, 0.8);
        }

        .more-btn {
            background: rgba(241, 196, 15, 0.8);
            border-color: rgba(241, 196, 15, 0.6);
        }

        .more-btn:hover {
            background: rgba(241, 196, 15, 1);
            border-color: rgba(241, 196, 15, 0.9);
            box-shadow: 
                0 10px 25px rgba(241, 196, 15, 0.4),
                0 0 20px rgba(241, 196, 15, 0.3);
            text-shadow: 0 0 12px rgba(241, 196, 15, 0.8);
        }

        /* Enhanced Wishes Screen */
        .wishes-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 95%;
            max-width: 500px;
            text-align: center;
            opacity: 0;
            visibility: hidden;
            transition: all 1s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            z-index: 2000;
            padding: 0 10px;
        }

        .wishes-container.active {
            opacity: 1;
            visibility: visible;
        }

        .wishes-message {
            background: 
                radial-gradient(circle at 70% 70%, rgba(46, 204, 113, 0.3) 0%, transparent 50%),
                rgba(255, 255, 255, 0.03);
            border: 2px solid rgba(46, 204, 113, 0.6);
            border-radius: 20px;
            padding: 30px 25px;
            margin-bottom: 25px;
            backdrop-filter: blur(20px);
            animation: wishesFloatUp 2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            position: relative;
            overflow: hidden;
        }

        .wishes-message::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(46, 204, 113, 0.2), transparent);
            animation: shimmerWish 6s ease-in-out infinite;
        }

        .wishes-message p {
            font-size: 1.1rem;
            line-height: 1.6;
            color: #f0f0f0;
            font-family: 'Georgia', serif;
            font-style: italic;
            margin: 0;
            text-shadow: 0 0 20px rgba(46, 204, 113, 0.6);
            position: relative;
            z-index: 1;
            letter-spacing: 0.3px;
        }

        @keyframes wishesFloatUp {
            0% {
                opacity: 0;
                transform: translateY(40px) scale(0.9);
                filter: blur(2px);
            }
            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
                filter: blur(0px);
            }
        }

        @keyframes shimmerWish {
            0%, 100% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            50% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }

        .back-btn {
            background: var(--accent-primary);
            border-color: var(--accent-secondary);
            animation: backBtnAppear 2.5s cubic-bezier(0.25, 0.46, 0.45, 0.94) 1s both;
        }

        @keyframes backBtnAppear {
            0% {
                opacity: 0;
                transform: translateY(25px) scale(0.8);
            }
            60% {
                opacity: 0.8;
                transform: translateY(-3px) scale(1.05);
            }
            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        /* Enhanced Black Hole speaking state */
        .black-hole-container.speaking .black-hole {
            box-shadow: 
                inset 0 0 80px var(--accent-primary),
                inset 0 0 150px var(--accent-secondary),
                0 0 200px var(--accent-primary),
                0 0 300px var(--accent-secondary);
            animation-duration: 4s;
        }

        .black-hole-container.speaking .black-hole::before {
            background: radial-gradient(circle, var(--accent-primary) 0%, transparent 60%);
            opacity: 0.8;
        }

        /* Progress Indicator */
        .progress-dots {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 8px;
            z-index: 3000;
        }

        .progress-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
        }

        .progress-dot.active {
            background: var(--accent-primary);
            transform: scale(1.2);
            box-shadow: 0 0 10px var(--accent-primary);
        }

        /* Touch Feedback */
        .touch-ripple {
            position: absolute;
            border-radius: 50%;
            background: radial-gradient(circle, var(--accent-primary), transparent);
            pointer-events: none;
            transform: scale(0);
            animation: rippleEffect 0.6s ease-out;
        }

        @keyframes rippleEffect {
            to {
                transform: scale(4);
                opacity: 0;
            }
        }

        /* Mobile-First Responsive Design */
        
        /* Extra Small Mobile Devices */
        @media (max-width: 320px) {
            .ask-text {
                font-size: 2.8rem;
                letter-spacing: 4px;
            }

            .oracle-subtitle {
                font-size: 0.9rem;
            }

            .floating-word.big {
                font-size: 1.8rem;
            }

            .floating-word.medium {
                font-size: 1.5rem;
            }

            .floating-word.small {
                font-size: 1.1rem;
            }

            .bright-message,
            .wishes-message {
                padding: 20px 15px;
                margin-bottom: 20px;
            }

            .bright-message p {
                font-size: 1rem;
                line-height: 1.5;
            }

            .wishes-message p {
                font-size: 0.95rem;
                line-height: 1.5;
            }

            .oracle-button {
                padding: 12px 25px;
                font-size: 0.95rem;
                width: 180px;
            }

            .message-actions {
                gap: 10px;
            }

            .black-hole-container {
                width: 95vmin;
                height: 95vmin;
            }
        }

        /* Standard Mobile Devices */
        @media (min-width: 321px) and (max-width: 414px) {
            .ask-text {
                font-size: 3.2rem;
                letter-spacing: 5px;
            }

            .floating-word.big {
                font-size: 2rem;
            }

            .floating-word.medium {
                font-size: 1.6rem;
            }

            .floating-word.small {
                font-size: 1.2rem;
            }

            .black-hole-container {
                width: 90vmin;
                height: 90vmin;
            }
        }

        /* Large Mobile Devices */
        @media (min-width: 415px) and (max-width: 768px) {
            .ask-text {
                font-size: 4.2rem;
                letter-spacing: 7px;
            }

            .floating-word.big {
                font-size: 2.6rem;
            }

            .floating-word.medium {
                font-size: 2.1rem;
            }

            .floating-word.small {
                font-size: 1.6rem;
            }

            .bright-message p {
                font-size: 1.3rem;
                line-height: 1.8;
            }

            .wishes-message p {
                font-size: 1.2rem;
                line-height: 1.7;
            }

            .oracle-button {
                padding: 16px 32px;
                font-size: 1.15rem;
                width: 220px;
            }

            .message-actions {
                gap: 18px;
            }
        }

        /* Tablet and Desktop */
        @media (min-width: 769px) {
            .control-panel {
                top: 10px;
                right: 10px;
            }

            .control-btn {
                padding: 6px 12px;
                font-size: 0.7rem;
                margin: 0 3px;
            }

            .ask-text {
                font-size: 4.8rem;
                letter-spacing: 8px;
            }

            .floating-word.big {
                font-size: 3rem;
                letter-spacing: 2px;
            }

            .floating-word.medium {
                font-size: 2.4rem;
            }

            .floating-word.small {
                font-size: 1.8rem;
            }

            .message-container,
            .wishes-container {
                width: 80%;
                max-width: 700px;
            }

            .bright-message,
            .wishes-message {
                padding: 40px 35px;
                margin-bottom: 30px;
            }

            .bright-message p {
                font-size: 1.5rem;
                line-height: 1.9;
            }

            .wishes-message p {
                font-size: 1.35rem;
                line-height: 1.8;
            }

            .oracle-button {
                padding: 18px 35px;
                font-size: 1.25rem;
                width: auto;
                min-width: 160px;
            }

            .message-actions {
                flex-direction: row;
                gap: 25px;
            }

            .black-hole-container {
                width: 75vmin;
                height: 75vmin;
            }
        }

        /* Landscape Mobile */
        @media (max-height: 500px) and (orientation: landscape) {
            .ask-text {
                font-size: 2.5rem;
                letter-spacing: 4px;
            }

            .oracle-subtitle {
                font-size: 0.9rem;
                margin-bottom: 15px;
            }

            .floating-word.big {
                font-size: 1.6rem;
            }

            .floating-word.medium {
                font-size: 1.3rem;
            }

            .floating-word.small {
                font-size: 1rem;
            }

            .bright-message,
            .wishes-message {
                padding: 15px 20px;
                margin-bottom: 15px;
            }

            .bright-message p {
                font-size: 0.95rem;
                line-height: 1.4;
            }

            .wishes-message p {
                font-size: 0.9rem;
                line-height: 1.4;
            }

            .oracle-button {
                padding: 10px 20px;
                font-size: 0.9rem;
                width: 150px;
            }

            .black-hole-container {
                width: 70vmin;
                height: 70vmin;
            }

            .message-actions {
                gap: 12px;
            }
        }
    </style>
</head>
<body class="theme-cosmic">
    <!-- Advanced Control Panel -->
    <div class="control-panel">
        <div class="control-row">
            <button class="control-btn active" onclick="switchLanguage('en')" data-lang="en">EN</button>
            <button class="control-btn" onclick="switchLanguage('zh')" data-lang="zh">中文</button>
        </div>
        <div class="control-row">
            <button class="control-btn active" onclick="switchTheme('cosmic')" data-theme="cosmic">🌌</button>
            <button class="control-btn" onclick="switchTheme('ethereal')" data-theme="ethereal">❄️</button>
            <button class="control-btn" onclick="switchTheme('mystical')" data-theme="mystical">🔮</button>
            <button class="control-btn" onclick="switchTheme('aurora')" data-theme="aurora">🌿</button>
        </div>
        <div class="control-row">
            <button class="control-btn" onclick="adjustGlow(-0.2)">🔅</button>
            <button class="control-btn" onclick="adjustGlow(0.2)">🔆</button>
            <button class="control-btn" onclick="toggleEffects()">⚡</button>
        </div>
    </div>

    <!-- Progress Indicator -->
    <div class="progress-dots">
        <div class="progress-dot active" data-step="0"></div>
        <div class="progress-dot" data-step="1"></div>
        <div class="progress-dot" data-step="2"></div>
        <div class="progress-dot" data-step="3"></div>
    </div>

    <!-- Main Oracle Container -->
    <div class="oracle-container">
        <div class="oracle-background">
            <div class="mystical-particles" id="mysticalParticles"></div>
            <div class="aurora-lights"></div>
        </div>
        
        <!-- Enhanced Black Hole Container -->
        <div class="black-hole-container" id="blackHoleContainer">
            <div class="black-hole">
                <!-- Advanced Sound Wave Visualization -->
                <div class="sound-wave-container" id="soundWaveContainer">
                    <div class="sound-wave"></div>
                    <div class="sound-wave"></div>
                    <div class="sound-wave"></div>
                    <div class="sound-wave"></div>
                </div>
            </div>
        </div>
        
        <!-- Landing Screen -->
        <div class="oracle-landing" id="oracleLanding">
            <div class="floating-ask" id="floatingAsk" onclick="showFloatingWords()">
                <span class="ask-text" data-en="aSk" data-zh="問">aSk</span>
                <div class="ask-glow"></div>
            </div>
            <div class="oracle-subtitle" data-en="What seeks to be known?" data-zh="什麼渴望被知曉？">What seeks to be known?</div>
        </div>
        
        <!-- Floating Words Screen -->
        <div class="floating-words-container" id="floatingWordsContainer">
            <div class="floating-words" id="floatingWords"></div>
        </div>
        
        <!-- Message Display -->
        <div class="message-container" id="messageContainer">
            <div class="bright-message" id="brightMessage"></div>
            <div class="message-actions" id="messageActions">
                <button class="oracle-button noted-btn" onclick="showWishes()" data-en="noTed" data-zh="記下">noTed</button>
                <button class="oracle-button more-btn" onclick="showMoreWords()" data-en="i wAnt moRe" data-zh="我想要更多">i wAnt moRe</button>
            </div>
        </div>
        
        <!-- Wishes Screen -->
        <div class="wishes-container" id="wishesContainer">
            <div class="wishes-message" id="wishesMessage"></div>
            <button class="oracle-button back-btn" onclick="returnToLanding()" data-en="aSk" data-zh="問">aSk</button>
        </div>
    </div>

    <script>
        // Enhanced Oracle System with Advanced Features
        let currentLanguage = 'en';
        let currentTheme = 'cosmic';
        let currentStep = 0;
        let glowIntensity = 1;
        let effectsEnabled = true;
        let sessionMemory = {
            usedWords: new Set(),
            usedMessages: new Set(),
            usedWishes: new Set(),
            themes: [],
            wordHistory: [],
            interactionCount: 0
        };

        // Advanced AI Word Generation with Context Awareness
        const contextualPrefixes = {
            en: {
                cosmic: ['stellar', 'cosmic', 'galactic', 'void', 'quantum'],
                ethereal: ['crystal', 'frost', 'azure', 'shimmer', 'luminous'],
                mystical: ['shadow', 'mystic', 'arcane', 'ethereal', 'phantom'],
                aurora: ['verdant', 'sylvan', 'bloom', 'forest', 'growth']
            },
            zh: {
                cosmic: ['星', '宇', '量', '虛', '時'],
                ethereal: ['晶', '霜', '藍', '光', '瑩'],
                mystical: ['影', '幻', '魅', '靈', '魂'],
                aurora: ['翠', '林', '花', '葉', '生']
            }
        };

        const advancedWordRoots = {
            en: {
                cosmic: ['nexus', 'vortex', 'infinity', 'dimensions', 'singularity', 'constellation', 'nebula', 'quasar'],
                ethereal: ['crystalline', 'gossamer', 'iridescent', 'luminescence', 'opalescent', 'prismatic', 'translucent'],
                mystical: ['enchantment', 'sorcery', 'divination', 'prophecy', 'grimoire', 'talisman', 'invocation'],
                aurora: ['flourish', 'verdure', 'blossom', 'nurture', 'cultivate', 'germinate', 'metamorphosis']
            },
            zh: {
                cosmic: ['星雲', '黑洞', '時空', '維度', '量子', '宇宙', '星際', '銀河'],
                ethereal: ['水晶', '冰霜', '光芒', '透明', '折射', '反射', '純淨', '澄澈'],
                mystical: ['神秘', '幻境', '魔法', '咒語', '預言', '占卜', '靈視', '超感'],
                aurora: ['綠意', '生機', '花開', '葉茂', '成長', '滋養', '蛻變', '新生']
            }
        };

        // Dynamic Story Templates with Emotional Intelligence
        const emotionalStoryTemplates = {
            en: {
                inspiring: "In the {realm} where {element} {action} with {emotion}, {entity} discovers that {revelation}. The {teacher} whispers: '{wisdom}.' Your {quality} becomes the {catalyst} that transforms {challenge} into {triumph}.",
                contemplative: "Through the {lens} of {perspective}, {phenomenon} reveals itself as {deeper_meaning}. What appears as {surface} carries the essence of {truth}. The {guide} knows that {insight} emerges when {condition} meets {readiness}.",
                mystical: "Between the {boundary_1} and {boundary_2}, where {mystery} dances with {reality}, {seeker} finds {hidden_knowledge}. The ancient {artifact} holds the secret: '{ancient_wisdom}.' Your path illuminates when {catalyst} awakens {dormant_power}."
            },
            zh: {
                inspiring: "在{境界}中，{元素}以{情感}{動作}，{存在}發現{啟示}。{導師}低語：'{智慧}。'你的{品質}成為將{挑戰}轉化為{勝利}的{催化劑}。",
                contemplative: "透過{視角}的{鏡頭}，{現象}顯現為{深層意義}。看似{表面}的承載著{真理}的本質。{指引者}知道當{條件}遇見{準備}時，{洞察}就會浮現。",
                mystical: "在{邊界一}與{邊界二}之間，{奧秘}與{實相}共舞的地方，{求道者}找到{隱藏知識}。古老的{聖物}保存著秘密：'{古老智慧}。'當{催化劑}喚醒{潛在力量}時，你的道路就會照亮。"
            }
        };

        // Advanced theme switching
        function switchTheme(theme) {
            currentTheme = theme;
            document.body.className = `theme-${theme}`;
            
            // Update active button
            document.querySelectorAll('[data-theme]').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-theme="${theme}"]`).classList.add('active');
            
            // Add to session memory
            sessionMemory.themes.push({theme, timestamp: Date.now()});
            
            // Visual feedback
            createThemeTransition();
        }

        function createThemeTransition() {
            const overlay = document.createElement('div');
            overlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100vw;
                height: 100vh;
                background: var(--accent-primary);
                opacity: 0.3;
                z-index: 5000;
                animation: themeFlash 0.6s ease-out;
                pointer-events: none;
            `;
            
            const style = document.createElement('style');
            style.textContent = `
                @keyframes themeFlash {
                    0% { opacity: 0; }
                    50% { opacity: 0.3; }
                    100% { opacity: 0; }
                }
            `;
            
            document.head.appendChild(style);
            document.body.appendChild(overlay);
            
            setTimeout(() => {
                document.body.removeChild(overlay);
                document.head.removeChild(style);
            }, 600);
        }

        // Advanced glow control
        function adjustGlow(delta) {
            glowIntensity = Math.max(0.2, Math.min(2, glowIntensity + delta));
            document.documentElement.style.setProperty('--glow-intensity', glowIntensity);
            
            // Visual feedback
            const blackHole = document.getElementById('blackHoleContainer');
            blackHole.style.transform = `translate(-50%, -50%) scale(${1 + delta * 0.1})`;
            
            setTimeout(() => {
                blackHole.style.transform = 'translate(-50%, -50%)';
            }, 200);
        }

        // Effects toggle
        function toggleEffects() {
            effectsEnabled = !effectsEnabled;
            const particles = document.getElementById('mysticalParticles');
            const aurora = document.querySelector('.aurora-lights');
            
            if (effectsEnabled) {
                particles.style.opacity = '1';
                aurora.style.opacity = '1';
                generateAdvancedParticles();
            } else {
                particles.style.opacity = '0.3';
                aurora.style.opacity = '0.3';
            }
        }

        // Language switching with enhanced feedback
        function switchLanguage(lang) {
            currentLanguage = lang;
            
            // Update language buttons
            document.querySelectorAll('[data-lang]').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-lang="${lang}"]`).classList.add('active');
            
            // Update text content
            document.querySelectorAll('[data-en]').forEach(element => {
                const key = lang === 'en' ? 'data-en' : 'data-zh';
                element.textContent = element.getAttribute(key);
            });
            
            setRandomGreeting();
            
            // Add ripple effect
            const btn = document.querySelector(`[data-lang="${lang}"]`);
            createRippleEffect(btn, event);
        }

        // Advanced touch feedback
        function createRippleEffect(element, event) {
            const rect = element.getBoundingClientRect();
            const ripple = document.createElement('div');
            const size = Math.max(rect.width, rect.height);
            
            ripple.className = 'touch-ripple';
            ripple.style.width = ripple.style.height = size + 'px';
            ripple.style.left = (event.clientX - rect.left - size / 2) + 'px';
            ripple.style.top = (event.clientY - rect.top - size / 2) + 'px';
            
            element.appendChild(ripple);
            
            setTimeout(() => {
                ripple.remove();
            }, 600);
        }

        // Progress tracking
        function updateProgress(step) {
            currentStep = step;
            document.querySelectorAll('.progress-dot').forEach((dot, index) => {
                dot.classList.toggle('active', index <= step);
            });
        }

        // Enhanced AI word generation with theme awareness
        function generateContextualWord() {
            const lang = currentLanguage;
            const theme = currentTheme;
            let attempts = 0;
            let word;
            
            do {
                const prefixes = contextualPrefixes[lang][theme];
                const roots = advancedWordRoots[lang][theme];
                
                const type = Math.random();
                
                if (type < 0.5) {
                    // Theme-aware prefix + root
                    const prefix = prefixes[Math.floor(Math.random() * prefixes.length)];
                    const root = roots[Math.floor(Math.random() * roots.length)];
                    word = lang === 'en' ? prefix + root.toLowerCase() : prefix + root;
                } else {
                    // Pure thematic root
                    word = roots[Math.floor(Math.random() * roots.length)];
                }
                
                attempts++;
            } while (sessionMemory.usedWords.has(word) && attempts < 50);
            
            sessionMemory.usedWords.add(word);
            sessionMemory.wordHistory.push({word, theme, timestamp: Date.now()});
            return word;
        }

        // Enhanced message generation with emotional intelligence
        function generateEmotionalMessage(word) {
            const lang = currentLanguage;
            const emotionalTone = sessionMemory.interactionCount < 3 ? 'inspiring' : 
                               sessionMemory.interactionCount < 6 ? 'contemplative' : 'mystical';
            
            let attempts = 0;
            let message;
            
            do {
                const template = emotionalStoryTemplates[lang][emotionalTone];
                
                // Context-aware element selection based on theme and history
                const elements = getThematicElements(currentTheme, lang);
                
                message = template.replace(/\{(\w+)\}/g, (match, key) => {
                    if (elements[key]) {
                        return elements[key][Math.floor(Math.random() * elements[key].length)];
                    }
                    return match;
                });
                
                // Add word-specific personalization with session context
                const personalizations = {
                    en: [
                        ` In the cosmic dance of "${word}", your journey finds new meaning.`,
                        ` The essence of "${word}" resonates with your soul's frequency.`,
                        ` Through "${word}", the universe whispers its deepest secrets.`
                    ],
                    zh: [
                        ` 在"${word}"的宇宙舞蹈中，你的旅程找到新的意義。`,
                        ` "${word}"的本質與你靈魂的頻率共鳴。`,
                        ` 通過"${word}"，宇宙低語著它最深的秘密。`
                    ]
                };
                
                const personalization = personalizations[lang][Math.floor(Math.random() * personalizations[lang].length)];
                message += personalization;
                
                attempts++;
            } while (sessionMemory.usedMessages.has(message) && attempts < 20);
            
            sessionMemory.usedMessages.add(message);
            sessionMemory.interactionCount++;
            return message;
        }

        function getThematicElements(theme, lang) {
            const thematicElements = {
                en: {
                    cosmic: {
                        realm: ['quantum field', 'stellar nursery', 'cosmic void', 'galactic core'],
                        element: ['stardust', 'dark matter', 'cosmic rays', 'gravitational waves'],
                        emotion: ['infinite wonder', 'cosmic awe', 'stellar passion', 'universal love']
                    },
                    ethereal: {
                        realm: ['crystal dimension', 'frozen palace', 'ice cathedral', 'winter sanctum'],
                        element: ['ice crystals', 'frost patterns', 'aurora light', 'diamond dust'],
                        emotion: ['serene clarity', 'crystalline peace', 'pristine joy', 'pure tranquility']
                    },
                    mystical: {
                        realm: ['shadow realm', 'enchanted grove', 'mystic chamber', 'arcane sanctuary'],
                        element: ['ethereal mist', 'phantom energy', 'spell weaves', 'magic essence'],
                        emotion: ['mystical longing', 'arcane fascination', 'enchanted wonder', 'magical bliss']
                    },
                    aurora: {
                        realm: ['emerald forest', 'verdant meadow', 'living grove', 'nature sanctuary'],
                        element: ['life force', 'growing energy', 'natural harmony', 'earth essence'],
                        emotion: ['natural joy', 'growing excitement', 'earthy satisfaction', 'blooming happiness']
                    }
                },
                zh: {
                    cosmic: {
                        境界: ['量子場域', '星際搖籃', '宇宙虛空', '銀河核心'],
                        元素: ['星塵', '暗物質', '宇宙射線', '重力波'],
                        情感: ['無限驚奇', '宇宙敬畏', '星際激情', '宇宙之愛']
                    },
                    ethereal: {
                        境界: ['水晶維度', '冰霜宮殿', '冰之聖殿', '冬日聖所'],
                        元素: ['冰晶', '霜花', '極光', '鑽石塵'],
                        情感: ['寧靜清澈', '水晶和平', '純淨喜悅', '純粹安詳']
                    },
                    mystical: {
                        境界: ['影之領域', '魅惑之林', '神秘密室', '奧術聖所'],
                        元素: ['以太薄霧', '幻影能量', '法術編織', '魔法精華'],
                        情感: ['神秘渴望', '奧術著迷', '魅惑驚奇', '魔法幸福']
                    },
                    aurora: {
                        境界: ['翡翠森林', '翠綠草原', '生命之林', '自然聖所'],
                        元素: ['生命力', '生長能量', '自然和諧', '大地精華'],
                        情感: ['自然喜悅', '成長興奮', '大地滿足', '綻放幸福']
                    }
                }
            };
            
            return thematicElements[lang][theme] || thematicElements[lang].cosmic;
        }

        // Enhanced particle system
        function generateAdvancedParticles() {
            const container = document.getElementById('mysticalParticles');
            if (!container) return;
            
            container.innerHTML = '';
            
            const particleCount = effectsEnabled ? 25 : 10;
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.classList.add('mystical-particle');
                
                // Theme-based particle behavior
                const behaviors = ['floating', 'gravitational', 'orbiting'];
                const behavior = behaviors[Math.floor(Math.random() * behaviors.length)];
                
                if (behavior === 'gravitational') {
                    particle.classList.add('gravitational');
                } else if (behavior === 'orbiting') {
                    particle.classList.add('orbiting');
                }
                
                // Random size between 2px and 12px
                const size = 2 + Math.random() * 10;
                particle.style.width = size + 'px';
                particle.style.height = size + 'px';
                
                // Theme-aware colors
                const colors = getThemeColors(currentTheme);
                const randomColor = colors[Math.floor(Math.random() * colors.length)];
                particle.style.background = `radial-gradient(circle, ${randomColor} 0%, transparent 70%)`;
                
                // Random horizontal position
                particle.style.left = Math.random() * 100 + '%';
                
                // Random animation delay and duration
                particle.style.animationDelay = Math.random() * 15 + 's';
                particle.style.animationDuration = (10 + Math.random() * 8) + 's';
                
                container.appendChild(particle);
            }
        }

        function getThemeColors(theme) {
            const themeColors = {
                cosmic: [
                    'rgba(186, 85, 211, 0.8)',
                    'rgba(138, 43, 226, 0.7)',
                    'rgba(147, 112, 219, 0.6)',
                    'rgba(123, 104, 238, 0.8)',
                    'rgba(221, 160, 221, 0.7)'
                ],
                ethereal: [
                    'rgba(100, 200, 255, 0.8)',
                    'rgba(150, 220, 255, 0.7)',
                    'rgba(200, 240, 255, 0.6)',
                    'rgba(180, 230, 255, 0.8)',
                    'rgba(220, 245, 255, 0.7)'
                ],
                mystical: [
                    'rgba(255, 100, 150, 0.8)',
                    'rgba(200, 50, 100, 0.7)',
                    'rgba(255, 150, 200, 0.6)',
                    'rgba(220, 80, 130, 0.8)',
                    'rgba(240, 120, 180, 0.7)'
                ],
                aurora: [
                    'rgba(100, 255, 150, 0.8)',
                    'rgba(50, 200, 100, 0.7)',
                    'rgba(150, 255, 200, 0.6)',
                    'rgba(80, 220, 130, 0.8)',
                    'rgba(120, 240, 180, 0.7)'
                ]
            };
            
            return themeColors[theme] || themeColors.cosmic;
        }

        // Enhanced greeting system
        const dynamicGreetings = {
            en: [
                "What seeks to be known?",
                "Ancient wisdom awaits your touch...",
                "The universe has been expecting you...",
                "Your soul's inquiry echoes through eternity...",
                "What mystery calls to your heart?",
                "The cosmic tapestry awaits your thread...",
                "What secrets does your spirit yearn to unveil?",
                "The infinite speaks through your curiosity..."
            ],
            zh: [
                "什麼渴望被知曉？",
                "古老的智慧等待你的觸碰...",
                "宇宙一直在等待你...",
                "你靈魂的詢問在永恆中回響...",
                "什麼奧秘在呼喚你的心？",
                "宇宙織錦等待你的絲線...",
                "你的靈魂渴望揭示什麼秘密？",
                "無限通過你的好奇心說話..."
            ]
        };

        function setRandomGreeting() {
            const subtitle = document.querySelector('.oracle-subtitle');
            if (subtitle) {
                const greetings = dynamicGreetings[currentLanguage];
                const randomGreeting = greetings[Math.floor(Math.random() * greetings.length)];
                subtitle.textContent = randomGreeting;
            }
        }

        // Initialize enhanced oracle
        document.addEventListener('DOMContentLoaded', function() {
            generateAdvancedParticles();
            activateAdvancedBlackHoleEffects();
            setRandomGreeting();
            updateProgress(0);
            
            // Initialize session
            sessionMemory.startTime = Date.now();
        });

        function activateAdvancedBlackHoleEffects() {
            setInterval(() => {
                const soundWaves = document.querySelectorAll('.sound-wave');
                const blackHoleContainer = document.getElementById('blackHoleContainer');
                
                if (Math.random() > 0.6) {
                    const effectType = Math.random();
                    
                    soundWaves.forEach(wave => {
                        wave.classList.add('active');
                        
                        if (effectType < 0.3) {
                            wave.classList.add('resonance');
                        } else if (effectType < 0.6) {
                            wave.classList.add('harmonic');
                        }
                    });
                    
                    blackHoleContainer.classList.add('speaking');
                    
                    setTimeout(() => {
                        soundWaves.forEach(wave => {
                            wave.classList.remove('active', 'resonance', 'harmonic');
                        });
                        blackHoleContainer.classList.remove('speaking');
                    }, 2500);
                }
            }, 4000);
        }

        function resetOracleScreens() {
            document.getElementById('oracleLanding').classList.remove('hidden');
            document.getElementById('floatingWordsContainer').classList.remove('active');
            document.getElementById('messageContainer').classList.remove('active');
            document.getElementById('wishesContainer').classList.remove('active');
        }

        function showFloatingWords() {
            updateProgress(1);
            
            // Enhanced activation feedback
            const askElement = document.getElementById('floatingAsk');
            askElement.classList.add('activated');
            
            // Activate advanced black hole effects
            const blackHoleContainer = document.getElementById('blackHoleContainer');
            const soundWaves = document.querySelectorAll('.sound-wave');
            
            blackHoleContainer.classList.add('expanded');
            soundWaves.forEach((wave, index) => {
                wave.classList.add('active', 'resonance');
                wave.style.animationDelay = (index * 0.1) + 's';
            });
            blackHoleContainer.classList.add('speaking');
            
            // Hide landing with enhanced transition
            const landing = document.getElementById('oracleLanding');
            landing.style.transform = 'translate(-50%, -50%) scale(0.8)';
            landing.style.opacity = '0';
            
            setTimeout(() => {
                landing.classList.add('hidden');
                landing.style.transform = 'translate(-50%, -50%) scale(1)';
                landing.style.opacity = '1';
                askElement.classList.remove('activated');
            }, 500);
            
            // Show enhanced floating words
            setTimeout(() => {
                const container = document.getElementById('floatingWordsContainer');
                const wordsContainer = document.getElementById('floatingWords');
                
                container.classList.add('active');
                wordsContainer.innerHTML = '';
                
                // Generate contextual AI words
                const wordCount = 12 + Math.floor(Math.random() * 4);
                
                for (let i = 0; i < wordCount; i++) {
                    const word = generateContextualWord();
                    const wordElement = document.createElement('div');
                    wordElement.classList.add('floating-word');
                    
                    // Enhanced size distribution
                    const sizeRandom = Math.random();
                    if (sizeRandom < 0.25) {
                        wordElement.classList.add('big');
                    } else if (sizeRandom < 0.7) {
                        wordElement.classList.add('medium');
                    } else {
                        wordElement.classList.add('small');
                    }
                    
                    wordElement.textContent = word;
                    wordElement.onclick = (e) => {
                        selectWord(wordElement, word, e);
                    };
                    
                    // Enhanced positioning algorithm
                    const angle = (i / wordCount) * 2 * Math.PI;
                    const radiusX = 30 + Math.random() * 25;
                    const radiusY = 25 + Math.random() * 20;
                    const centerX = 50;
                    const centerY = 45;
                    
                    const x = centerX + radiusX * Math.cos(angle) + (Math.random() - 0.5) * 12;
                    const y = centerY + radiusY * Math.sin(angle) + (Math.random() - 0.5) * 12;
                    
                    wordElement.style.left = Math.max(8, Math.min(85, x)) + '%';
                    wordElement.style.top = Math.max(15, Math.min(75, y)) + '%';
                    
                    // Enhanced animations
                    wordElement.style.animationDelay = (i * 0.15 + Math.random() * 0.4) + 's';
                    wordElement.style.animationDuration = (7 + Math.random() * 5) + 's';
                    
                    wordsContainer.appendChild(wordElement);
                }
                
                // Deactivate effects after words appear
                setTimeout(() => {
                    soundWaves.forEach(wave => {
                        wave.classList.remove('active', 'resonance');
                    });
                    blackHoleContainer.classList.remove('speaking', 'expanded');
                }, 3000);
            }, 600);
        }

        function selectWord(element, word, event) {
            // Enhanced word selection feedback
            element.classList.add('selected');
            createRippleEffect(element, event);
            
            // Animate other words out
            document.querySelectorAll('.floating-word').forEach(otherWord => {
                if (otherWord !== element) {
                    otherWord.style.animation = 'wordFloat 0.5s ease-out forwards';
                    otherWord.style.opacity = '0';
                }
            });
            
            setTimeout(() => {
                showBrightMessage(word);
            }, 600);
        }

        function showBrightMessage(word) {
            updateProgress(2);
            
            // Enhanced black hole activation
            const blackHoleContainer = document.getElementById('blackHoleContainer');
            const soundWaves = document.querySelectorAll('.sound-wave');
            
            blackHoleContainer.classList.add('expanded');
            soundWaves.forEach(wave => {
                wave.classList.add('active', 'harmonic');
            });
            blackHoleContainer.classList.add('speaking');
            
            // Hide floating words
            const wordsContainer = document.getElementById('floatingWordsContainer');
            wordsContainer.style.opacity = '0';
            
            setTimeout(() => {
                wordsContainer.classList.remove('active');
                wordsContainer.style.opacity = '1';
            }, 400);
            
            // Show enhanced message
            setTimeout(() => {
                const messageContainer = document.getElementById('messageContainer');
                const messageElement = document.getElementById('brightMessage');
                
                messageContainer.classList.add('active');
                
                // Generate emotional AI message
                const message = generateEmotionalMessage(word);
                
                // Enhanced typing effect
                typeMessageWithEffects(messageElement, message);
                
                // Enhanced deactivation
                setTimeout(() => {
                    soundWaves.forEach(wave => {
                        wave.classList.remove('active', 'harmonic');
                    });
                    blackHoleContainer.classList.remove('speaking', 'expanded');
                }, 4000);
                
            }, 600);
        }

        function typeMessageWithEffects(element, message) {
            element.innerHTML = '<p></p>';
            const paragraph = element.querySelector('p');
            let index = 0;
            
            function typeCharacter() {
                if (index < message.length) {
                    paragraph.textContent += message.charAt(index);
                    index++;
                    
                    // Enhanced typing with sound wave sync
                    if (Math.random() > 0.8) {
                        const waves = document.querySelectorAll('.sound-wave');
                        waves.forEach(wave => {
                            wave.style.borderColor = `var(--accent-${['primary', 'secondary', 'tertiary'][Math.floor(Math.random() * 3)]})`;
                        });
                    }
                    
                    // Variable typing speed
                    const delay = message.charAt(index - 1) === '.' ? 400 : 
                                 message.charAt(index - 1) === ',' ? 200 : 
                                 Math.random() * 60 + 25;
                    
                    setTimeout(typeCharacter, delay);
                }
            }
            
            typeCharacter();
        }

        function showWishes() {
            updateProgress(3);
            
            // Enhanced black hole activation for wishes
            const blackHoleContainer = document.getElementById('blackHoleContainer');
            const soundWaves = document.querySelectorAll('.sound-wave');
            
            soundWaves.forEach(wave => {
                wave.classList.add('active', 'resonance');
            });
            blackHoleContainer.classList.add('speaking');
            
            document.getElementById('messageContainer').classList.remove('active');
            
            setTimeout(() => {
                const wishesContainer = document.getElementById('wishesContainer');
                const wishesElement = document.getElementById('wishesMessage');
                
                wishesContainer.classList.add('active');
                
                // Generate advanced AI wish
                const wish = generateAdvancedWish();
                
                typeMessageWithEffects(wishesElement, wish);
                
                setTimeout(() => {
                    soundWaves.forEach(wave => {
                        wave.classList.remove('active', 'resonance');
                    });
                    blackHoleContainer.classList.remove('speaking');
                }, 4000);
                
            }, 500);
        }

        function generateAdvancedWish() {
            const lang = currentLanguage;
            const sessionContext = analyzeSessionContext();
            
            const advancedWishTemplates = {
                en: [
                    `May the ${sessionContext.dominantTheme} energies of your journey illuminate the path ahead, bringing ${sessionContext.personalizedBlessing} to your ${sessionContext.lifeAspect}...`,
                    `In this moment of cosmic alignment, may the wisdom you've gathered through ${sessionContext.wordCount} sacred words transform into ${sessionContext.manifestation} that enriches your soul...`,
                    `As the universe recognizes your ${sessionContext.seekerQuality}, may ${sessionContext.cosmicGift} flow into your life with the grace of ${sessionContext.naturalPhenomenon}...`
                ],
                zh: [
                    `願你旅程中的${sessionContext.dominantTheme}能量照亮前方道路，為你的${sessionContext.lifeAspect}帶來${sessionContext.personalizedBlessing}...`,
                    `在這宇宙對齊的時刻，願你通過${sessionContext.wordCount}個神聖詞語收集的智慧轉化為豐富你靈魂的${sessionContext.manifestation}...`,
                    `當宇宙認可你的${sessionContext.seekerQuality}時，願${sessionContext.cosmicGift}以${sessionContext.naturalPhenomenon}的恩典流入你的生命...`
                ]
            };
            
            const template = advancedWishTemplates[lang][Math.floor(Math.random() * advancedWishTemplates[lang].length)];
            return template;
        }

        function analyzeSessionContext() {
            return {
                dominantTheme: currentTheme === 'cosmic' ? '宇宙' : currentTheme === 'ethereal' ? '空靈' : currentTheme === 'mystical' ? '神秘' : '自然',
                wordCount: sessionMemory.wordHistory.length,
                personalizedBlessing: ['和諧', '智慧', '平靜', '力量'][Math.floor(Math.random() * 4)],
                lifeAspect: ['心靈', '旅程', '成長', '覺醒'][Math.floor(Math.random() * 4)],
                manifestation: ['奇蹟', '洞察', '轉化', '啟發'][Math.floor(Math.random() * 4)],
                seekerQuality: ['真誠', '勇氣', '好奇心', '開放性'][Math.floor(Math.random() * 4)],
                cosmicGift: ['宇宙恩典', '天體祝福', '星際能量', '無限愛意'][Math.floor(Math.random() * 4)],
                naturalPhenomenon: ['流水', '微風', '晨光', '花香'][Math.floor(Math.random() * 4)]
            };
        }

        function showMoreWords() {
            document.getElementById('messageContainer').classList.remove('active');
            updateProgress(1);
            
            setTimeout(() => {
                showFloatingWords();
            }, 500);
        }

        function returnToLanding() {
            updateProgress(0);
            
            document.getElementById('wishesContainer').classList.remove('active');
            
            setTimeout(() => {
                setRandomGreeting();
                resetOracleScreens();
            }, 500);
        }

        // Enhanced touch support for mobile
        document.addEventListener('touchstart', function(e) {
            if (e.target.classList.contains('oracle-button') || 
                e.target.classList.contains('floating-word') || 
                e.target.classList.contains('floating-ask')) {
                createRippleEffect(e.target, e.touches[0]);
            }
        });

        // Performance optimization for mobile
        if (window.innerWidth <= 768) {
            // Reduce particle count on mobile
            const originalGenerate = generateAdvancedParticles;
            generateAdvancedParticles = function() {
                const container = document.getElementById('mysticalParticles');
                if (!container) return;
                
                container.innerHTML = '';
                const particleCount = 15; // Reduced for mobile
                
                for (let i = 0; i < particleCount; i++) {
                    const particle = document.createElement('div');
                    particle.classList.add('mystical-particle');
                    
                    const size = 2 + Math.random() * 6; // Smaller particles
                    particle.style.width = size + 'px';
                    particle.style.height = size + 'px';
                    
                    const colors = getThemeColors(currentTheme);
                    const randomColor = colors[Math.floor(Math.random() * colors.length)];
                    particle.style.background = `radial-gradient(circle, ${randomColor} 0%, transparent 70%)`;
                    
                    particle.style.left = Math.random() * 100 + '%';
                    particle.style.animationDelay = Math.random() * 10 + 's';
                    particle.style.animationDuration = (8 + Math.random() * 4) + 's';
                    
                    container.appendChild(particle);
                }
            };
        }
    </script>
</body>
</html>
