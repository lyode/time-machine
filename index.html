<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Voice Assistant - Your Intelligent Companion</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .aurora-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 50%, rgba(255, 107, 157, 0.4) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(138, 43, 226, 0.4) 0%, transparent 50%),
                radial-gradient(circle at 40% 80%, rgba(30, 144, 255, 0.4) 0%, transparent 50%);
            animation: aurora 15s ease-in-out infinite;
            pointer-events: none;
            transition: opacity 2s ease-out;
        }

        @keyframes aurora {
            0%, 100% { opacity: 0.6; transform: scale(1) rotate(0deg); }
            33% { opacity: 0.8; transform: scale(1.1) rotate(1deg); }
            66% { opacity: 0.4; transform: scale(0.9) rotate(-1deg); }
        }

        .main-content {
            text-align: center;
            position: relative;
            z-index: 1;
            max-width: 650px;
            padding: 50px 40px;
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(25px);
            border-radius: 30px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 25px 70px rgba(0, 0, 0, 0.3);
            transition: all 2s ease-out;
        }

        .title {
            font-size: 3.2rem;
            margin-bottom: 20px;
            background: linear-gradient(135deg, #ff6b9d, #c44bd1, #4a90e2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 700;
            animation: shimmer 3s ease-in-out infinite;
            line-height: 1.1;
        }

        @keyframes shimmer {
            0%, 100% { filter: hue-rotate(0deg); }
            50% { filter: hue-rotate(30deg); }
        }

        .subtitle {
            font-size: 1.3rem;
            margin-bottom: 30px;
            opacity: 0.9;
            color: #ff6b9d;
            font-style: italic;
            font-weight: 300;
        }

        .description {
            font-size: 1.1rem;
            line-height: 1.7;
            margin-bottom: 50px;
            opacity: 0.85;
            color: #e8e8e8;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
        }

        .launch-button {
            display: inline-block;
            padding: 25px 50px;
            background: linear-gradient(135deg, #ff6b9d, #c44bd1);
            color: white;
            text-decoration: none;
            border-radius: 60px;
            font-size: 1.4rem;
            font-weight: 700;
            transition: all 0.4s ease;
            box-shadow: 0 15px 40px rgba(255, 107, 157, 0.4);
            border: 2px solid rgba(255, 255, 255, 0.3);
            position: relative;
            overflow: hidden;
            margin-bottom: 40px;
            letter-spacing: 0.5px;
            cursor: pointer;
        }

        .launch-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.6s;
        }

        .launch-button:hover::before {
            left: 100%;
        }

        .launch-button:hover {
            transform: translateY(-4px) scale(1.08);
            box-shadow: 0 20px 50px rgba(255, 107, 157, 0.7);
            background: linear-gradient(135deg, #ff7ba3, #d056d9);
            border-color: rgba(255, 255, 255, 0.5);
        }

        .launch-button:active {
            transform: translateY(-2px) scale(1.05);
        }

        .button-icon {
            margin-right: 12px;
            font-size: 1.5rem;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .features {
            text-align: left;
            background: rgba(255, 255, 255, 0.06);
            border-radius: 25px;
            padding: 35px;
            border: 1px solid rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
        }

        .features h3 {
            color: #ff6b9d;
            margin-bottom: 20px;
            font-size: 1.4rem;
            text-align: center;
            font-weight: 600;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
            list-style: none;
            padding: 0;
        }

        .feature-item {
            padding: 12px 0;
            padding-left: 30px;
            position: relative;
            font-size: 1rem;
            line-height: 1.5;
            color: #e8e8e8;
            transition: color 0.3s ease;
        }

        .feature-item::before {
            content: '‚ú®';
            position: absolute;
            left: 0;
            color: #ff6b9d;
            font-size: 1.2rem;
            animation: sparkle 3s ease-in-out infinite;
        }

        .feature-item:nth-child(even)::before {
            animation-delay: 1.5s;
        }

        @keyframes sparkle {
            0%, 100% { transform: scale(1) rotate(0deg); opacity: 0.7; }
            50% { transform: scale(1.2) rotate(180deg); opacity: 1; }
        }

        .floating-elements {
            position: absolute;
            width: 100%;
            height: 100%;
            overflow: hidden;
            pointer-events: none;
            transition: opacity 2s ease-out;
        }

        .floating-element {
            position: absolute;
            color: rgba(255, 107, 157, 0.4);
            font-size: 2.5rem;
            animation: float 8s ease-in-out infinite;
        }

        .floating-element:nth-child(1) {
            top: 10%;
            left: 10%;
            animation-delay: 0s;
        }

        .floating-element:nth-child(2) {
            top: 20%;
            right: 15%;
            animation-delay: 2s;
        }

        .floating-element:nth-child(3) {
            bottom: 25%;
            left: 20%;
            animation-delay: 4s;
        }

        .floating-element:nth-child(4) {
            bottom: 15%;
            right: 10%;
            animation-delay: 1s;
        }

        .floating-element:nth-child(5) {
            top: 60%;
            left: 5%;
            animation-delay: 3s;
        }

        .floating-element:nth-child(6) {
            top: 40%;
            right: 5%;
            animation-delay: 5s;
        }

        @keyframes float {
            0%, 100% {
                transform: translateY(0px) rotate(0deg);
                opacity: 0.4;
            }
            50% {
                transform: translateY(-30px) rotate(180deg);
                opacity: 0.8;
            }
        }

        /* Space Overlay Styles */
        .space-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(ellipse at center, #1a1a2e 0%, #0f0f23 50%, #000 100%);
            opacity: 0;
            visibility: hidden;
            transition: all 2s ease-in-out;
            z-index: 1000;
        }

        .space-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .stars-container {
            position: absolute;
            width: 100%;
            height: 100%;
            animation: rotate 120s linear infinite;
            transform-origin: center center;
        }

        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation: twinkle 3s ease-in-out infinite;
        }

        .star.small {
            width: 1px;
            height: 1px;
            box-shadow: 0 0 6px rgba(255, 255, 255, 0.8);
        }

        .star.medium {
            width: 2px;
            height: 2px;
            box-shadow: 0 0 8px rgba(255, 255, 255, 0.9);
        }

        .star.large {
            width: 3px;
            height: 3px;
            box-shadow: 0 0 12px rgba(255, 255, 255, 1);
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.3; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.2); }
        }

        /* Moving Background Objects */
        .space-objects {
            position: absolute;
            width: 100%;
            height: 100%;
            overflow: hidden;
            pointer-events: none;
        }

        .space-object {
            position: absolute;
            border-radius: 50%;
            animation: drift 20s linear infinite;
        }

        .space-object.nebula1 {
            width: 120px;
            height: 120px;
            background: radial-gradient(circle, rgba(255, 107, 157, 0.3) 0%, transparent 70%);
            top: 20%;
            left: -120px;
            animation-duration: 25s;
        }

        .space-object.nebula2 {
            width: 80px;
            height: 80px;
            background: radial-gradient(circle, rgba(138, 43, 226, 0.4) 0%, transparent 70%);
            top: 60%;
            left: -80px;
            animation-duration: 35s;
            animation-delay: 10s;
        }

        .space-object.comet {
            width: 4px;
            height: 4px;
            background: white;
            box-shadow: 0 0 10px rgba(255, 255, 255, 1), -20px 0 15px rgba(255, 255, 255, 0.3);
            top: 30%;
            left: -50px;
            animation-duration: 15s;
            animation-delay: 5s;
        }

        @keyframes drift {
            from { transform: translateX(0); }
            to { transform: translateX(calc(100vw + 200px)); }
        }

        /* Black Hole Effect */
        .black-hole-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 0;
            height: 0;
            transition: all 4s ease-in-out;
            z-index: 1001;
        }

        .black-hole-container.expanding {
            width: 80vmin;
            height: 80vmin;
        }

        .black-hole {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: 
                radial-gradient(circle at center, 
                    transparent 25%, 
                    rgba(0, 0, 0, 0.1) 30%, 
                    rgba(0, 0, 0, 0.6) 45%, 
                    rgba(0, 0, 0, 0.9) 55%, 
                    black 65%);
            box-shadow: 
                inset 0 0 50px rgba(255, 107, 157, 0.3),
                inset 0 0 100px rgba(138, 43, 226, 0.2),
                0 0 100px rgba(0, 0, 0, 0.8);
            animation: blackHoleSwirl 8s linear infinite;
            position: relative;
            overflow: hidden;
        }

        .black-hole::before {
            content: '';
            position: absolute;
            top: 5%;
            left: 5%;
            width: 90%;
            height: 90%;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(255, 107, 157, 0.15) 0%, transparent 60%);
            animation: accretionDisk 6s linear infinite reverse;
        }

        @keyframes blackHoleSwirl {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        @keyframes counterRotate {
            from { transform: translate(-50%, -50%) rotate(0deg); }
            to { transform: translate(-50%, -50%) rotate(-360deg); }
        }

        @keyframes accretionDisk {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .chatgpt-iframe {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90%;
            height: 90%;
            border: none;
            border-radius: 50%;
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(15px);
            opacity: 0;
            transition: opacity 2s ease-in-out;
            z-index: 1001;
            box-shadow: 
                inset 0 0 30px rgba(255, 107, 157, 0.1),
                inset 0 0 60px rgba(0, 0, 0, 0.9),
                0 0 30px rgba(0, 0, 0, 0.9);
            animation: counterRotate 8s linear infinite;
            overflow: hidden;
        }

        .chatgpt-iframe.show {
            opacity: 1;
        }

        /* Voice Interface Overlay */
        .voice-interface-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80%;
            height: 80%;
            border-radius: 50%;
            background: transparent;
            opacity: 0;
            transition: opacity 2s ease-in-out;
            z-index: 1003;
            animation: counterRotate 8s linear infinite;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-end;
            padding-bottom: 60px;
            pointer-events: none;
        }

        .voice-interface-overlay.show {
            opacity: 1;
        }

        .gpt-speaking-indicator {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: radial-gradient(circle at 30% 30%, 
                rgba(255, 107, 157, 0.9) 0%, 
                rgba(138, 43, 226, 0.7) 50%, 
                rgba(74, 144, 226, 0.5) 100%);
            margin-bottom: 30px;
            animation: speakingPulse 2s ease-in-out infinite;
            box-shadow: 
                0 0 30px rgba(255, 107, 157, 0.6),
                inset 0 0 20px rgba(255, 255, 255, 0.2);
            position: relative;
            overflow: hidden;
            pointer-events: auto;
        }

        .gpt-speaking-indicator::before {
            content: 'ü§ñ';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 2.2rem;
            animation: iconFloat 3s ease-in-out infinite;
        }

        .gpt-speaking-indicator.active {
            animation: speakingActive 0.5s ease-in-out infinite;
            box-shadow: 
                0 0 50px rgba(255, 107, 157, 1),
                0 0 100px rgba(138, 43, 226, 0.8),
                inset 0 0 30px rgba(255, 255, 255, 0.4);
        }

        @keyframes speakingPulse {
            0%, 100% { 
                transform: scale(1);
                opacity: 0.8;
            }
            50% { 
                transform: scale(1.05);
                opacity: 1;
            }
        }

        @keyframes speakingActive {
            0%, 100% { 
                transform: scale(1);
                box-shadow: 
                    0 0 50px rgba(255, 107, 157, 1),
                    0 0 100px rgba(138, 43, 226, 0.8);
            }
            25% { 
                transform: scale(1.3);
                box-shadow: 
                    0 0 80px rgba(255, 107, 157, 1),
                    0 0 150px rgba(138, 43, 226, 1);
            }
            75% { 
                transform: scale(0.9);
                box-shadow: 
                    0 0 40px rgba(255, 107, 157, 0.8),
                    0 0 80px rgba(138, 43, 226, 0.6);
            }
        }

        @keyframes iconFloat {
            0%, 100% { transform: translate(-50%, -50%) rotate(0deg); }
            50% { transform: translate(-50%, -50%) rotate(5deg) scale(1.05); }
        }

        .voice-mode-button {
            background: linear-gradient(135deg, #ff6b9d, #c44bd1);
            color: white;
            border: none;
            padding: 18px 35px;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(255, 107, 157, 0.5);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            pointer-events: auto;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        .voice-mode-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            transition: left 0.6s;
        }

        .voice-mode-button:hover::before {
            left: 100%;
        }

        .voice-mode-button:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 15px 40px rgba(255, 107, 157, 0.8);
            background: linear-gradient(135deg, #ff7ba3, #d056d9);
        }

        .voice-mode-button.active {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            animation: pulse 0.5s ease-in-out infinite;
        }

        .settings-button {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            font-size: 1.2rem;
            cursor: pointer;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            z-index: 1003;
            opacity: 0;
            animation: fadeInUp 1s ease-out 6.5s forwards;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .settings-button:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.1);
            box-shadow: 0 5px 20px rgba(255, 255, 255, 0.3);
        }

        .settings-panel {
            position: absolute;
            bottom: 80px;
            right: 20px;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            padding: 20px;
            width: 300px;
            opacity: 0;
            visibility: hidden;
            transform: translateY(20px);
            transition: all 0.3s ease;
            z-index: 1004;
        }

        .settings-panel.show {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .settings-panel h3 {
            color: #ff6b9d;
            margin-bottom: 15px;
            font-size: 1.1rem;
            text-align: center;
        }

        .test-button {
            background: linear-gradient(135deg, #4a90e2, #2c5aa0);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 25px;
            font-size: 0.9rem;
            cursor: pointer;
            margin: 5px;
            transition: all 0.3s ease;
            width: calc(50% - 10px);
            display: inline-block;
        }

        .test-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(74, 144, 226, 0.4);
        }

        .chatgpt-link {
            background: linear-gradient(135deg, #ff6b9d, #c44bd1);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            font-size: 0.9rem;
            cursor: pointer;
            margin-top: 10px;
            transition: all 0.3s ease;
            width: 100%;
            text-decoration: none;
            display: block;
            text-align: center;
        }

        .chatgpt-link:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 107, 157, 0.4);
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .loading-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: rgba(255, 255, 255, 0.8);
            font-size: 1.2rem;
            text-align: center;
            opacity: 1;
            transition: opacity 1s ease-in-out;
            z-index: 1004;
        }

        .loading-text.hidden {
            opacity: 0;
        }

        .fade-out {
            opacity: 0 !important;
            transform: scale(0.8) !important;
            visibility: hidden !important;
        }

        /* Floating Light Effects */
        .light-particles {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 999;
        }

        .light-particle {
            position: absolute;
            width: 2px;
            height: 2px;
            background: rgba(255, 255, 255, 0.6);
            border-radius: 50%;
            animation: floatLight 12s ease-in-out infinite;
        }

        @keyframes floatLight {
            0%, 100% {
                transform: translateY(100vh) translateX(0) scale(0);
                opacity: 0;
            }
            10% {
                opacity: 1;
                transform: translateY(90vh) translateX(10px) scale(1);
            }
            90% {
                opacity: 1;
                transform: translateY(-10vh) translateX(-10px) scale(1);
            }
            100% {
                transform: translateY(-20vh) translateX(0) scale(0);
                opacity: 0;
            }
        }

        @media (max-width: 768px) {
            .main-content {
                margin: 20px;
                padding: 40px 25px;
                max-width: 90vw;
            }
            
            .title {
                font-size: 2.8rem;
            }
            
            .subtitle {
                font-size: 1.1rem;
                margin-bottom: 25px;
            }

            .description {
                font-size: 1rem;
                margin-bottom: 40px;
            }
            
            .launch-button {
                padding: 20px 40px;
                font-size: 1.2rem;
            }

            .feature-grid {
                grid-template-columns: 1fr;
            }

            .black-hole-container.expanding {
                width: 90vmin;
                height: 90vmin;
            }

            .chatgpt-iframe {
                width: 85%;
                height: 85%;
            }

            .portal-indicator {
                width: 30px;
                height: 30px;
            }

            .voice-status-indicator {
                font-size: 0.8rem;
                padding: 8px 15px;
                top: -40px;
            }

            .portal-instructions {
                font-size: 0.75rem;
                padding: 10px 15px;
                max-width: 250px;
                bottom: -60px;
            }

            .settings-button {
                width: 45px;
                height: 45px;
                font-size: 1.1rem;
                bottom: 15px;
                right: 15px;
            }

            .settings-panel {
                width: 280px;
                bottom: 70px;
                right: 15px;
                padding: 15px;
            }

            .test-button {
                font-size: 0.8rem;
                padding: 8px 12px;
            }

            .chatgpt-link {
                font-size: 0.8rem;
                padding: 10px 15px;
            }
        }

        @media (max-width: 480px) {
            .title {
                font-size: 2.4rem;
            }
            
            .launch-button {
                padding: 18px 35px;
                font-size: 1.1rem;
            }

            .chatgpt-iframe {
                width: 90%;
                height: 90%;
            }

            .portal-indicator {
                width: 25px;
                height: 25px;
            }

            .voice-status-indicator {
                font-size: 0.75rem;
                padding: 6px 12px;
                top: -35px;
            }

            .portal-instructions {
                font-size: 0.7rem;
                padding: 8px 12px;
                max-width: 220px;
                bottom: -50px;
            }

            .settings-button {
                width: 40px;
                height: 40px;
                font-size: 1rem;
                bottom: 10px;
                right: 10px;
            }

            .settings-panel {
                width: 260px;
                bottom: 60px;
                right: 10px;
                padding: 12px;
            }

            .settings-panel h3 {
                font-size: 1rem;
            }

            .test-button {
                font-size: 0.75rem;
                padding: 6px 10px;
            }

            .chatgpt-link {
                font-size: 0.75rem;
                padding: 8px 12px;
            }
        }

        /* Animation keyframes */
        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes slideOutRight {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }
        
        @keyframes fadeInUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
    </style>
</head>
<body>
    <div class="aurora-bg"></div>
    
    <div class="floating-elements">
        <div class="floating-element">üé§</div>
        <div class="floating-element">üíï</div>
        <div class="floating-element">ü§ñ</div>
        <div class="floating-element">‚ú®</div>
        <div class="floating-element">üåü</div>
        <div class="floating-element">üí´</div>
    </div>
    
    <div class="main-content">
        <h1 class="title">AI Voice Assistant</h1>
        
        <p class="subtitle">Your intelligent companion with forced voice capabilities</p>
        
        <p class="description">
            Experience ChatGPT enhanced with portal voice capabilities! Speak your messages and hear responses through our cosmic interface. 
            Your ChatGPT conversation loads inside the portal with forced voice synthesis for the ultimate AI interaction experience.
        </p>
        
        <a href="#" onclick="launchAssistant(); return false;" class="launch-button">
            <span class="button-icon">üöÄ</span>
            Launch AI Assistant
        </a>
        
        <div class="features">
            <h3>‚ú® Key Features</h3>
            <ul class="feature-grid">
        <li class="feature-item">DIRECT ChatGPT voice activation through portal interface</li>
                <li class="feature-item">Forces ChatGPT to speak through your iPhone speaker</li>
                <li class="feature-item">Automatic ChatGPT voice mode detection and activation</li>
                <li class="feature-item">Beautiful cosmic interface with ChatGPT integration</li>
                <li class="feature-item">Device speaker optimization for clear ChatGPT audio</li>
                <li class="feature-item">Multiple ChatGPT voice activation methods</li>
                <li class="feature-item">Bypasses manual activation - forces direct voice output</li>
                <li class="feature-item">Professional iPhone speaker integration</li>
            </ul>
        </div>
    </div>

    <!-- Space Overlay -->
    <div class="space-overlay" id="spaceOverlay">
        <div class="stars-container" id="starsContainer">
            <!-- Stars will be generated by JavaScript -->
        </div>
        
        <div class="space-objects">
            <div class="space-object nebula1"></div>
            <div class="space-object nebula2"></div>
            <div class="space-object comet"></div>
        </div>

        <div class="light-particles" id="lightParticles">
            <!-- Light particles will be generated by JavaScript -->
        </div>
        
        <div class="loading-text" id="loadingText">
            üåå Opening cosmic portal...<br>
            <small style="opacity: 0.7;">Forcing voice activation...</small>
        </div>
        
        <div class="black-hole-container" id="blackHoleContainer">
            <div class="black-hole">
                <!-- ChatGPT as interactive base layer -->
                <iframe class="chatgpt-iframe" id="chatgptFrame" src=""></iframe>
                
                <!-- Portal frame overlay for visual effects -->
                <div class="portal-frame-overlay"></div>
                
                <!-- Floating corner indicators -->
                <div class="portal-indicator top-left"></div>
                <div class="portal-indicator top-right"></div>
                <div class="portal-indicator bottom-left"></div>
                <div class="portal-indicator bottom-right"></div>
                
                <!-- Voice status indicator -->
                <div class="voice-status-indicator" id="voiceStatus">
                    üé§ Click Voice Button in ChatGPT Below
                </div>
                
                <!-- Instructions overlay -->
                <div class="portal-instructions" id="portalInstructions">
                    Look for the üé§ microphone button inside ChatGPT and click it to activate voice mode!
                </div>
            </div>
        </div>

        <button class="settings-button" id="settingsBtn" onclick="toggleSettings()">
            ‚öôÔ∏è
        </button>

        <div class="settings-panel" id="settingsPanel">
            <h3>üé§ Portal Voice Guide</h3>
            <button class="test-button" onclick="showVoiceGuide()">üìã Voice Guide</button>
            <button class="test-button" onclick="testDeviceAudio()">üîä Test Audio</button>
            <button class="test-button" onclick="refreshChatGPT()">üîÑ Refresh ChatGPT</button>
            <button class="test-button" onclick="toggleInstructions()">üí° Show Tips</button>
            <a href="https://chatgpt.com/c/685f5529-0888-800c-b96a-008419428418" 
               target="_blank" 
               class="chatgpt-link">
                üöÄ Open in New Tab
            </a>
        </div>
    </div>

    <script>
        // Global voice system variables
        window.forcedVoiceActive = false;
        window.audioContext = null;
        window.micStream = null;
        window.recognition = null;
        window.forcedVoice = null;

        function launchAssistant() {
            // Fade out main content
            const mainContent = document.querySelector('.main-content');
            const auroraBackground = document.querySelector('.aurora-bg');
            const floatingElements = document.querySelector('.floating-elements');
            
            mainContent.classList.add('fade-out');
            auroraBackground.classList.add('fade-out');
            floatingElements.classList.add('fade-out');
            
            // Show space overlay after a delay
            setTimeout(() => {
                const spaceOverlay = document.getElementById('spaceOverlay');
                spaceOverlay.classList.add('active');
                
                // Generate stars and light particles
                generateStars();
                generateLightParticles();
                
                // Start black hole animation
                setTimeout(() => {
                    openBlackHole();
                }, 2000);
            }, 500);
        }

        function generateStars() {
            const starsContainer = document.getElementById('starsContainer');
            const starCount = 150;
            
            for (let i = 0; i < starCount; i++) {
                const star = document.createElement('div');
                star.classList.add('star');
                
                // Random star size
                const size = Math.random();
                if (size < 0.6) {
                    star.classList.add('small');
                } else if (size < 0.9) {
                    star.classList.add('medium');
                } else {
                    star.classList.add('large');
                }
                
                // Random position
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                
                // Random animation delay
                star.style.animationDelay = Math.random() * 3 + 's';
                
                starsContainer.appendChild(star);
            }
        }

        function generateLightParticles() {
            const lightParticles = document.getElementById('lightParticles');
            const particleCount = 20;
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.classList.add('light-particle');
                
                // Random horizontal position
                particle.style.left = Math.random() * 100 + '%';
                
                // Random animation delay and duration
                particle.style.animationDelay = Math.random() * 12 + 's';
                particle.style.animationDuration = (8 + Math.random() * 8) + 's';
                
                lightParticles.appendChild(particle);
            }
        }

        function openBlackHole() {
            const loadingText = document.getElementById('loadingText');
            const blackHoleContainer = document.getElementById('blackHoleContainer');
            
            // Update loading text
            loadingText.innerHTML = 'üï≥Ô∏è Black hole opening...<br><small style="opacity: 0.7;">Preparing forced voice system...</small>';
            
            // Expand black hole
            blackHoleContainer.classList.add('expanding');
            
            // Load ChatGPT after black hole opens
            setTimeout(() => {
                loadChatGPT();
            }, 4000);
        }

        function loadChatGPT() {
            const loadingText = document.getElementById('loadingText');
            const chatgptFrame = document.getElementById('chatgptFrame');
            const voiceInterface = document.getElementById('voiceInterface');
            
            // Force load specific ChatGPT conversation
            chatgptFrame.src = 'https://chatgpt.com/c/685f5529-0888-800c-b96a-008419428418';
            
            // Update loading text
            loadingText.innerHTML = 'üöÄ ChatGPT Loading...<br><small style="opacity: 0.7;">Forcing ChatGPT voice activation...</small>';
            
            // Initialize audio system for device speakers
            initializeDeviceAudio();
            
            // Set up ChatGPT voice activation
            setupChatGPTVoiceActivation(chatgptFrame);
            
            // Show ChatGPT and voice interface
            setTimeout(() => {
                chatgptFrame.classList.add('show');
                voiceInterface.classList.add('show');
                loadingText.classList.add('hidden');
                
                // Auto-activate ChatGPT voice after everything loads
                setTimeout(() => {
                    forceChatGPTVoiceMode();
                }, 3000);
            }, 2000);
        }

        function initializeDeviceAudio() {
            try {
                // Force enable device audio context for iPhone/mobile
                window.audioContext = new (window.AudioContext || window.webkitAudioContext)();
                
                // Resume audio context for iOS
                const resumeAudio = () => {
                    if (window.audioContext.state === 'suspended') {
                        window.audioContext.resume().then(() => {
                            console.log('iPhone/device audio context activated');
                            playDeviceActivationSound();
                        });
                    }
                };
                
                // Auto-resume on any user interaction
                document.addEventListener('touchstart', resumeAudio, { once: true });
                document.addEventListener('click', resumeAudio, { once: true });
                
                // Try immediate activation
                resumeAudio();
                
            } catch (error) {
                console.log('Device audio initialization error:', error);
            }
        }

        function playDeviceActivationSound() {
            try {
                // Play activation sound through device speakers
                const oscillator = window.audioContext.createOscillator();
                const gainNode = window.audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(window.audioContext.destination);
                
                oscillator.frequency.setValueAtTime(1200, window.audioContext.currentTime);
                gainNode.gain.setValueAtTime(0, window.audioContext.currentTime);
                gainNode.gain.linearRampToValueAtTime(0.2, window.audioContext.currentTime + 0.1);
                gainNode.gain.exponentialRampToValueAtTime(0.01, window.audioContext.currentTime + 0.5);
                
                oscillator.start();
                oscillator.stop(window.audioContext.currentTime + 0.5);
                
                console.log('Device speakers activated successfully');
            } catch (error) {
                console.log('Device speaker test error:', error);
            }
        }

        function setupChatGPTVoiceActivation(iframe) {
            console.log('Setting up ChatGPT voice activation...');
            
            iframe.onload = function() {
                setTimeout(() => {
                    // Try multiple methods to activate ChatGPT voice
                    activateChatGPTVoiceMode();
                }, 2000);
            };
            
            // Monitor for ChatGPT voice activation
            monitorChatGPTVoiceStatus();
        }

        function forceChatGPTVoiceMode() {
            console.log('Forcing ChatGPT voice mode activation...');
            
            const chatFrame = document.getElementById('chatgptFrame');
            
            try {
                // Method 1: Try to access iframe and click voice button
                const iframeDoc = chatFrame.contentDocument || chatFrame.contentWindow.document;
                
                if (iframeDoc) {
                    // Look for ChatGPT voice button
                    const voiceButton = findChatGPTVoiceButton(iframeDoc);
                    
                    if (voiceButton) {
                        voiceButton.click();
                        console.log('ChatGPT voice button clicked successfully!');
                        showVoiceActivationSuccess();
                        return true;
                    }
                }
                
            } catch (error) {
                console.log('Direct ChatGPT access blocked:', error);
            }
            
            // Method 2: PostMessage to ChatGPT
            try {
                chatFrame.contentWindow.postMessage({
                    type: 'activate_voice_mode',
                    source: 'portal'
                }, '*');
                
                console.log('Voice activation message sent to ChatGPT');
                
            } catch (error) {
                console.log('PostMessage to ChatGPT failed:', error);
            }
            
            // Method 3: Show manual activation instructions
            showVoiceActivationInstructions();
        }

        function findChatGPTVoiceButton(doc) {
            // Try various selectors for ChatGPT voice button
            const selectors = [
                '[aria-label*="voice"]',
                '[aria-label*="microphone"]',
                'button[data-testid*="voice"]',
                'button[title*="voice"]',
                '.voice-button',
                '[class*="voice"]',
                'button:has(svg[class*="microphone"])',
                'button:has([data-icon="microphone"])'
            ];
            
            for (const selector of selectors) {
                try {
                    const button = doc.querySelector(selector);
                    if (button) {
                        console.log('Found ChatGPT voice button:', selector);
                        return button;
                    }
                } catch (e) {
                    continue;
                }
            }
            
            // Fallback: look for any button with microphone-related text or icons
            const buttons = doc.querySelectorAll('button');
            for (const button of buttons) {
                const text = button.textContent || button.innerHTML || '';
                if (text.toLowerCase().includes('voice') || 
                    text.toLowerCase().includes('microphone') ||
                    text.includes('üé§')) {
                    console.log('Found voice button by content');
                    return button;
                }
            }
            
            return null;
        }

        function showVoiceActivationSuccess() {
            const indicator = document.getElementById('speakingIndicator');
            indicator.classList.add('active');
            
            // Show success message
            showNotification('üé§ ChatGPT Voice Activated!', 'ChatGPT voice mode is now active. Speak directly to ChatGPT and it will respond through your iPhone speaker!', 'success');
        }

        function showVoiceActivationInstructions() {
            // Create instruction overlay for manual activation
            const instructionOverlay = document.createElement('div');
            instructionOverlay.style.cssText = `
                position: fixed;
                top: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: rgba(0, 0, 0, 0.95);
                color: white;
                padding: 25px;
                border-radius: 20px;
                border: 2px solid rgba(255, 107, 157, 0.6);
                backdrop-filter: blur(15px);
                z-index: 10000;
                max-width: 400px;
                text-align: center;
                animation: fadeInUp 0.5s ease-out;
                box-shadow: 0 20px 40px rgba(0, 0, 0, 0.7);
            `;
            
            instructionOverlay.innerHTML = `
                <h3 style="color: #ff6b9d; margin-bottom: 20px; font-size: 1.3rem;">üé§ Activate ChatGPT Voice</h3>
                <p style="margin-bottom: 15px; line-height: 1.5; font-size: 1rem;">
                    <strong>To enable ChatGPT voice on iPhone:</strong><br><br>
                    1. <strong>Look for the microphone button</strong> (üé§) in ChatGPT below<br>
                    2. <strong>Tap the voice button</strong> in the chat interface<br>
                    3. <strong>Allow microphone access</strong> when prompted<br>
                    4. <strong>ChatGPT will speak directly</strong> through your iPhone speaker
                </p>
                <button onclick="this.parentElement.remove(); retryVoiceActivation();" 
                        style="background: linear-gradient(135deg, #ff6b9d, #c44bd1); 
                               color: white; border: none; padding: 12px 25px; 
                               border-radius: 25px; cursor: pointer; margin: 10px 5px;
                               font-size: 1rem; font-weight: 600;">
                    üîÑ Try Auto-Activate Again
                </button>
                <button onclick="this.parentElement.remove();" 
                        style="background: linear-gradient(135deg, #4a90e2, #2c5aa0); 
                               color: white; border: none; padding: 12px 25px; 
                               border-radius: 25px; cursor: pointer; margin: 10px 5px;
                               font-size: 1rem; font-weight: 600;">
                    ‚úÖ I'll Do It Manually
                </button>
            `;
            
            document.body.appendChild(instructionOverlay);
            
            // Auto-remove after 30 seconds
            setTimeout(() => {
                if (instructionOverlay.parentElement) {
                    instructionOverlay.remove();
                }
            }, 30000);
        }

        function retryVoiceActivation() {
            console.log('Retrying ChatGPT voice activation...');
            setTimeout(() => {
                forceChatGPTVoiceMode();
            }, 1000);
        }

        function showNotification(title, message, type = 'info') {
            const notification = document.createElement('div');
            const bgColor = type === 'success' ? 'rgba(39, 174, 96, 0.9)' : 
                           type === 'error' ? 'rgba(231, 76, 60, 0.9)' : 
                           'rgba(52, 152, 219, 0.9)';
            
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${bgColor};
                color: white;
                padding: 15px 20px;
                border-radius: 10px;
                border: 1px solid rgba(255, 255, 255, 0.3);
                backdrop-filter: blur(10px);
                z-index: 10001;
                max-width: 300px;
                font-size: 0.9rem;
                animation: slideInRight 0.3s ease-out;
            `;
            
            notification.innerHTML = `
                <strong>${title}</strong><br>
                <span style="opacity: 0.9;">${message}</span>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                if (notification.parentElement) {
                    notification.style.animation = 'slideOutRight 0.3s ease-in';
                    setTimeout(() => notification.remove(), 300);
                }
            }, 5000);
        }

        function monitorChatGPTVoiceStatus() {
            // Monitor for ChatGPT voice activity
            let checkCount = 0;
            
            const monitorInterval = setInterval(() => {
                checkCount++;
                
                try {
                    const chatFrame = document.getElementById('chatgptFrame');
                    
                    // Check if ChatGPT voice might be active
                    if (navigator.mediaDevices) {
                        navigator.mediaDevices.enumerateDevices().then(devices => {
                            const audioOutputs = devices.filter(device => device.kind === 'audiooutput');
                            if (audioOutputs.length > 0) {
                                console.log('Audio output devices available:', audioOutputs.length);
                            }
                        });
                    }
                    
                } catch (error) {
                    console.log('Voice monitoring error:', error);
                }
                
                if (checkCount >= 20) { // Stop after 20 checks
                    clearInterval(monitorInterval);
                }
                
            }, 3000);
        }

        function initializeForcedVoiceSystem() {
            // Initialize device audio for ChatGPT voice output
            if ('speechSynthesis' in window) {
                // Only initialize for device audio testing, not for robot speech
                console.log('Device audio capabilities available');
            }
            
            // Focus on enabling device speakers for ChatGPT
            try {
                window.audioContext = new (window.AudioContext || window.webkitAudioContext)();
                window.audioContext.resume().then(() => {
                    console.log('Device audio ready for ChatGPT voice output');
                    playDeviceActivationSound();
                });
            } catch (error) {
                console.log('Device audio initialization error:', error);
            }
        }

        // Remove portal robot speech - focus only on ChatGPT voice activation
        function testChatGPTConnection() {
            const btn = event.target;
            btn.innerHTML = 'ü§ñ Testing...';
            btn.disabled = true;
            
            const chatFrame = document.getElementById('chatgptFrame');
            
            try {
                // Test if ChatGPT iframe is loaded
                if (chatFrame && chatFrame.src.includes('chatgpt.com')) {
                    console.log('ChatGPT connection test successful');
                    showNotification(
                        'ü§ñ ChatGPT Connected!', 
                        'Your ChatGPT conversation is loaded. Ready to activate voice mode for iPhone speaker output.',
                        'success'
                    );
                    
                    btn.innerHTML = 'ü§ñ ChatGPT Connected!';
                    btn.style.background = 'linear-gradient(135deg, #27ae60, #2ecc71)';
                    
                    // Try to activate voice mode
                    setTimeout(() => {
                        activateChatGPTVoiceMode();
                    }, 1000);
                    
                } else {
                    showNotification(
                        'ü§ñ Connection Issue', 
                        'ChatGPT conversation may still be loading. Please wait and try again.',
                        'error'
                    );
                    
                    btn.innerHTML = 'ü§ñ Connection Issue';
                    btn.style.background = 'linear-gradient(135deg, #f39c12, #e67e22)';
                }
                
            } catch (error) {
                showNotification(
                    'ü§ñ Limited Access', 
                    'ChatGPT connection has limited access due to browser security. Manual voice activation may be required.',
                    'error'
                );
                
                btn.innerHTML = 'ü§ñ Limited Access';
                btn.style.background = 'linear-gradient(135deg, #e74c3c, #c0392b)';
            }
            
            setTimeout(() => {
                btn.innerHTML = 'ü§ñ Test ChatGPT';
                btn.style.background = 'linear-gradient(135deg, #4a90e2, #2c5aa0)';
                btn.disabled = false;
            }, 5000);
        }

        function forceSpeakerTest() {
            const btn = event.target;
            btn.innerHTML = 'üîä Testing...';
            btn.disabled = true;
            
            // Test device speakers for ChatGPT voice output
            playDeviceActivationSound();
            
            showNotification(
                'üîä Speaker Test', 
                'Device speaker test completed. Your iPhone speakers are ready for ChatGPT voice output.',
                'success'
            );
            
            btn.innerHTML = 'üîä iPhone Speakers Ready!';
            btn.style.background = 'linear-gradient(135deg, #27ae60, #2ecc71)';
            
            setTimeout(() => {
                btn.innerHTML = 'üîä Test Portal Voice';
                btn.style.background = 'linear-gradient(135deg, #4a90e2, #2c5aa0)';
                btn.disabled = false;
            }, 4000);
        }

        function autoActivateForcedVoice() {
            // Automatically try to activate ChatGPT's own voice system
            console.log('Auto-activating ChatGPT voice mode...');
            
            const btn = document.getElementById('voiceModeBtn');
            if (btn) {
                // Don't auto-click, just show ready state
                btn.innerHTML = 'üé§ READY TO ACTIVATE CHATGPT VOICE';
                btn.style.background = 'linear-gradient(135deg, #f39c12, #e67e22)';
                
                // Try to auto-activate ChatGPT voice
                setTimeout(() => {
                    forceChatGPTVoiceMode();
                }, 1000);
            }
        }

        function activateChatGPTVoiceMode() {
            // This function focuses on activating ChatGPT's built-in voice
            const chatFrame = document.getElementById('chatgptFrame');
            
            try {
                // Method 1: Try to find and click ChatGPT's voice button
                const iframeDoc = chatFrame.contentDocument || chatFrame.contentWindow.document;
                
                if (iframeDoc) {
                    // Look for various voice-related elements in ChatGPT
                    const voiceSelectors = [
                        '[data-testid*="voice"]',
                        '[aria-label*="voice"]',
                        '[aria-label*="speak"]',
                        '[title*="voice"]',
                        'button[class*="voice"]',
                        '.voice-mode-button',
                        '[data-component="voice"]'
                    ];
                    
                    for (const selector of voiceSelectors) {
                        const element = iframeDoc.querySelector(selector);
                        if (element) {
                            element.click();
                            console.log('ChatGPT voice element clicked:', selector);
                            showNotification(
                                'üé§ Success!', 
                                'ChatGPT voice mode activated! Your iPhone speaker should now output ChatGPT responses.',
                                'success'
                            );
                            return true;
                        }
                    }
                    
                    // Try to find microphone-related buttons
                    const buttons = iframeDoc.querySelectorAll('button');
                    for (const button of buttons) {
                        const text = button.textContent || button.innerHTML;
                        if (text.includes('üé§') || 
                            text.toLowerCase().includes('voice') ||
                            text.toLowerCase().includes('speak') ||
                            button.getAttribute('aria-label')?.toLowerCase().includes('voice')) {
                            button.click();
                            console.log('ChatGPT voice button found and clicked');
                            showNotification(
                                'üé§ Voice Activated!', 
                                'Found and activated ChatGPT voice button. Check if voice mode is now active.',
                                'success'
                            );
                            return true;
                        }
                    }
                }
                
            } catch (error) {
                console.log('ChatGPT voice activation error:', error);
            }
            
            // Method 2: Try keyboard shortcuts for voice activation
            try {
                const chatFrame = document.getElementById('chatgptFrame');
                
                // Send common voice activation shortcuts
                const shortcuts = [
                    { key: 'v', ctrlKey: true }, // Ctrl+V for voice (common shortcut)
                    { key: 'm', ctrlKey: true }, // Ctrl+M for microphone
                    { key: ' ', ctrlKey: true }  // Ctrl+Space for voice
                ];
                
                shortcuts.forEach((shortcut, index) => {
                    setTimeout(() => {
                        const keyEvent = new KeyboardEvent('keydown', shortcut);
                        chatFrame.contentWindow.dispatchEvent(keyEvent);
                    }, index * 500);
                });
                
                console.log('Sent voice activation keyboard shortcuts to ChatGPT');
                
            } catch (error) {
                console.log('Keyboard shortcut method failed:', error);
            }
            
            return false;
        }

        function activateForcedVoiceMode() {
            const btn = document.getElementById('voiceModeBtn');
            const indicator = document.getElementById('speakingIndicator');
            
            if (window.forcedVoiceActive) {
                // Stop voice mode
                stopForcedVoiceMode();
                return;
            }
            
            // Start ChatGPT voice activation mode
            btn.innerHTML = 'üé§ ACTIVATING CHATGPT VOICE';
            btn.classList.add('active');
            btn.style.background = 'linear-gradient(135deg, #e74c3c, #c0392b)';
            
            // Activate speaking indicator
            indicator.classList.add('active');
            
            window.forcedVoiceActive = true;
            
            // Try to force activate ChatGPT voice
            forceChatGPTVoiceMode();
            
            // Set up microphone for ChatGPT (not portal robot)
            navigator.mediaDevices.getUserMedia({ 
                audio: {
                    echoCancellation: true,
                    noiseSuppression: true,
                    autoGainControl: true,
                    sampleRate: 48000
                }
            })
                .then(function(stream) {
                    window.micStream = stream;
                    
                    btn.innerHTML = 'üé§ CHATGPT VOICE READY';
                    
                    // Don't initialize speech recognition for portal
                    // Just monitor ChatGPT's own voice activation
                    monitorChatGPTVoiceMode();
                    
                    // Instructions message
                    showNotification(
                        'üé§ ChatGPT Voice Mode', 
                        'Microphone ready! Please activate voice mode in ChatGPT interface for direct iPhone speaker output.',
                        'info'
                    );
                })
                .catch(function(error) {
                    console.log('Microphone access error:', error);
                    btn.innerHTML = 'üé§ MIC ACCESS DENIED';
                    btn.style.background = 'linear-gradient(135deg, #e74c3c, #c0392b)';
                    
                    // Still try to activate ChatGPT voice without mic
                    setTimeout(() => {
                        showNotification(
                            '‚ö†Ô∏è Microphone Denied', 
                            'Microphone access denied, but you can still manually activate ChatGPT voice mode for iPhone speaker output.',
                            'error'
                        );
                        btn.innerHTML = 'üé§ MANUAL ACTIVATION ONLY';
                        window.forcedVoiceActive = true;
                    }, 2000);
                });
        }

        function monitorChatGPTVoiceMode() {
            // Monitor for when ChatGPT's voice mode becomes active
            console.log('Monitoring ChatGPT voice mode activation...');
            
            let checkCount = 0;
            const checkInterval = setInterval(() => {
                checkCount++;
                
                try {
                    const chatFrame = document.getElementById('chatgptFrame');
                    
                    // Try to detect if ChatGPT voice is active
                    if (navigator.mediaDevices) {
                        navigator.mediaDevices.enumerateDevices().then(devices => {
                            const audioInputs = devices.filter(device => device.kind === 'audioinput');
                            const audioOutputs = devices.filter(device => device.kind === 'audiooutput');
                            
                            if (audioInputs.length > 0 && audioOutputs.length > 0) {
                                // Check if any audio streams are active
                                navigator.mediaDevices.getUserMedia({audio: true})
                                    .then(stream => {
                                        if (stream.active) {
                                            console.log('Audio stream detected - ChatGPT voice might be active');
                                            showNotification(
                                                'üé§ Voice Detected!', 
                                                'Audio activity detected. ChatGPT voice mode may be active.',
                                                'success'
                                            );
                                        }
                                        stream.getTracks().forEach(track => track.stop());
                                    })
                                    .catch(e => console.log('Audio check failed:', e));
                            }
                        });
                    }
                    
                } catch (error) {
                    console.log('Voice mode monitoring error:', error);
                }
                
                if (checkCount >= 10) {
                    clearInterval(checkInterval);
                    console.log('Voice mode monitoring completed');
                }
                
            }, 5000);
        }

        function stopForcedVoiceMode() {
            const btn = document.getElementById('voiceModeBtn');
            const indicator = document.getElementById('speakingIndicator');
            
            window.forcedVoiceActive = false;
            
            // Stop microphone stream
            if (window.micStream) {
                window.micStream.getTracks().forEach(track => track.stop());
                window.micStream = null;
            }
            
            // Reset UI
            btn.innerHTML = 'üé§ ACTIVATE CHATGPT VOICE';
            btn.classList.remove('active');
            btn.style.background = 'linear-gradient(135deg, #ff6b9d, #c44bd1)';
            indicator.classList.remove('active');
            
            console.log('ChatGPT voice activation stopped');
        }

        function stopForcedVoiceMode() {
            const btn = document.getElementById('voiceModeBtn');
            const indicator = document.getElementById('speakingIndicator');
            
            window.forcedVoiceActive = false;
            
            // Stop recognition
            if (window.recognition) {
                window.recognition.stop();
                window.recognition = null;
            }
            
            // Stop microphone stream
            if (window.micStream) {
                window.micStream.getTracks().forEach(track => track.stop());
                window.micStream = null;
            }
            
            // Stop any speaking
            if ('speechSynthesis' in window) {
                window.speechSynthesis.cancel();
            }
            
            // Reset UI
            btn.innerHTML = 'üé§ FORCE VOICE MODE';
            btn.classList.remove('active');
            btn.style.background = 'linear-gradient(135deg, #ff6b9d, #c44bd1)';
            indicator.classList.remove('active');
            
            console.log('Forced voice mode stopped');
        }

        function initializeForcedSpeechRecognition() {
            if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                window.recognition = new SpeechRecognition();
                
                window.recognition.continuous = true;
                window.recognition.interimResults = true;
                window.recognition.lang = 'en-US';
                
                window.recognition.onstart = function() {
                    console.log('Voice recognition started - connected to ChatGPT');
                    playNotificationSound(523.25); // C5
                };
                
                window.recognition.onresult = function(event) {
                    let finalTranscript = '';
                    
                    for (let i = event.resultIndex; i < event.results.length; i++) {
                        if (event.results[i].isFinal) {
                            finalTranscript += event.results[i][0].transcript;
                        }
                    }
                    
                    if (finalTranscript) {
                        console.log('Voice input for ChatGPT:', finalTranscript);
                        
                        // Announce what user said
                        forcedSpeak("You said: " + finalTranscript + ". Sending to ChatGPT...");
                        
                        // Try to send to ChatGPT
                        sendToChatGPT(finalTranscript);
                        
                        playNotificationSound(659.25); // E5
                    }
                };
                
                window.recognition.onerror = function(event) {
                    console.log('Speech recognition error:', event.error);
                    
                    // Announce error through portal voice
                    forcedSpeak("Voice recognition error occurred. Restarting listening system...");
                    
                    // Don't stop on error, just restart
                    if (window.forcedVoiceActive) {
                        setTimeout(() => {
                            if (window.forcedVoiceActive) {
                                window.recognition.start();
                            }
                        }, 1000);
                    }
                };
                
                window.recognition.onend = function() {
                    console.log('Speech recognition ended');
                    
                    // Auto-restart if still active
                    if (window.forcedVoiceActive) {
                        setTimeout(() => {
                            if (window.forcedVoiceActive) {
                                window.recognition.start();
                            }
                        }, 100);
                    }
                };
                
                window.recognition.start();
            }
        }

        function sendToChatGPT(message) {
            const chatFrame = document.getElementById('chatgptFrame');
            
            try {
                // Method 1: Try direct iframe manipulation
                const iframeDoc = chatFrame.contentDocument || chatFrame.contentWindow.document;
                const textArea = iframeDoc.querySelector('textarea');
                const input = iframeDoc.querySelector('input[type="text"]');
                
                if (textArea) {
                    textArea.value = message;
                    textArea.focus();
                    
                    // Trigger input events
                    textArea.dispatchEvent(new Event('input', { bubbles: true }));
                    textArea.dispatchEvent(new Event('change', { bubbles: true }));
                    
                    // Try to find and click send button
                    const sendButton = iframeDoc.querySelector('button[type="submit"]') || 
                                     iframeDoc.querySelector('[aria-label*="Send"]') ||
                                     iframeDoc.querySelector('button:last-of-type');
                    
                    if (sendButton) {
                        setTimeout(() => {
                            sendButton.click();
                            forcedSpeak("Message sent to ChatGPT successfully!");
                        }, 500);
                    } else {
                        forcedSpeak("Message typed in ChatGPT. Please press Enter or click Send to submit.");
                    }
                    
                    return true;
                }
                
            } catch (error) {
                console.log('Direct ChatGPT access blocked:', error);
            }
            
            // Method 2: PostMessage attempt
            try {
                chatFrame.contentWindow.postMessage({
                    type: 'insert_text',
                    text: message
                }, 'https://chatgpt.com');
                
                forcedSpeak("Voice message sent to ChatGPT via portal communication. Please check if it appeared in the chat interface.");
                
            } catch (error) {
                console.log('PostMessage failed:', error);
                
                // Method 3: Provide instructions
                forcedSpeak("I captured your voice input: " + message + ". Due to browser security, please manually type this into the ChatGPT interface or I can help you interact with it through other methods.");
            }
        }

        function forcedSpeak(text) {
            if ('speechSynthesis' in window && text) {
                // Cancel any existing speech
                window.speechSynthesis.cancel();
                
                const utterance = new SpeechSynthesisUtterance(text);
                
                if (window.forcedVoice) {
                    utterance.voice = window.forcedVoice;
                }
                
                utterance.volume = 1.0;
                utterance.rate = 0.9;
                utterance.pitch = 1.1;
                
                utterance.onstart = function() {
                    const indicator = document.getElementById('speakingIndicator');
                    indicator.classList.add('active');
                    playNotificationSound(783.99); // G5
                };
                
                utterance.onend = function() {
                    const indicator = document.getElementById('speakingIndicator');
                    setTimeout(() => {
                        indicator.classList.remove('active');
                    }, 500);
                };
                
                utterance.onerror = function(event) {
                    console.log('Speech synthesis error:', event.error);
                };
                
                window.speechSynthesis.speak(utterance);
                return true;
            }
            return false;
        }

        function generateAIResponse(input) {
            const responses = {
                "portal help": "Portal voice commands: Say 'send to chatgpt' plus your message, 'read chatgpt' to attempt reading responses, 'portal status' for system info, or just speak normally to send messages to ChatGPT!",
                "portal status": "Portal voice system is connected to ChatGPT conversation. Voice input is active, speech synthesis is operational, and I'm monitoring the ChatGPT interface for responses.",
                "send to chatgpt": "I'm ready! Say your message after this and I'll send it to ChatGPT for you.",
                "read chatgpt": "Attempting to read ChatGPT responses... Unfortunately, browser security prevents me from reading the exact text, but I can monitor for activity and provide feedback.",
                "chatgpt": "Yes, I'm connected to your ChatGPT conversation! I can help by sending your voice messages to ChatGPT and providing voice feedback about the conversation.",
                hello: "Hello! I'm your portal voice assistant connected to ChatGPT. Speak your message and I'll send it to ChatGPT for you!",
                hi: "Hi there! The portal voice system is active and connected to your ChatGPT conversation. What would you like to ask ChatGPT?",
                how: "The portal voice system is working perfectly! I'm connected to ChatGPT and ready to help you communicate with it using voice.",
                what: "I'm your portal voice assistant that bridges your voice input to ChatGPT. I can send your speech to ChatGPT and provide voice feedback!",
                who: "I'm your cosmic voice assistant speaking from the portal, connected to your ChatGPT conversation to enhance your experience with voice capabilities!",
                why: "I exist to make your ChatGPT experience better by adding voice input and audio feedback through this beautiful cosmic portal interface!",
                where: "I'm speaking from the dimensional portal that contains your ChatGPT conversation. I act as a voice bridge between you and ChatGPT!",
                help: "I can send your voice messages to ChatGPT, monitor for responses, and provide voice feedback. Try saying something you want to ask ChatGPT!",
                voice: "Yes! I provide voice capabilities for your ChatGPT conversation. Speak naturally and I'll send your message to ChatGPT!",
                portal: "This cosmic portal contains your ChatGPT conversation with enhanced voice capabilities. I'm here to help you interact with ChatGPT using voice!",
                space: "We're communicating through a dimensional ChatGPT portal in outer space! Your conversation is enhanced with cosmic voice capabilities!",
                amazing: "Thank you! The portal makes ChatGPT interactions much more engaging with voice capabilities and this beautiful cosmic interface!",
                beautiful: "I agree! This cosmic ChatGPT portal with voice capabilities is absolutely stunning and functional!",
                thank: "You're welcome! I'm happy to enhance your ChatGPT experience with voice capabilities through this cosmic portal!",
                goodbye: "Goodbye! Your ChatGPT conversation will remain active in the portal. The voice system will be here whenever you need it!",
                bye: "Bye! Thanks for using the portal voice system with ChatGPT. Come back anytime for voice-enhanced conversations!",
                test: "Portal voice system test successful! I'm connected to ChatGPT and ready to process your voice messages. Everything is working perfectly!",
                default: "I heard: " + input + ". Sending this message to ChatGPT now..."
            };
            
            const lowerInput = input.toLowerCase();
            
            // Check for portal commands first
            for (const [key, response] of Object.entries(responses)) {
                if (key !== 'default' && lowerInput.includes(key)) {
                    return response;
                }
            }
            
            // If no special command, treat as message for ChatGPT
            return responses.default;
        }

        function playNotificationSound(frequency) {
            if (window.audioContext) {
                try {
                    const oscillator = window.audioContext.createOscillator();
                    const gainNode = window.audioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(window.audioContext.destination);
                    
                    oscillator.frequency.setValueAtTime(frequency, window.audioContext.currentTime);
                    gainNode.gain.setValueAtTime(0, window.audioContext.currentTime);
                    gainNode.gain.linearRampToValueAtTime(0.1, window.audioContext.currentTime + 0.05);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, window.audioContext.currentTime + 0.3);
                    
                    oscillator.start();
                    oscillator.stop(window.audioContext.currentTime + 0.3);
                } catch (error) {
                    console.log('Notification sound error:', error);
                }
            }
        }

        function toggleSettings() {
            const settingsPanel = document.getElementById('settingsPanel');
            settingsPanel.classList.toggle('show');
        }

        function forceSpeakerTest() {
            const btn = event.target;
            btn.innerHTML = 'üîä Testing...';
            btn.disabled = true;
            
            // Test forced speech
            forcedSpeak("Speaker test successful! I can speak directly from the cosmic portal with crystal clear voice.");
            
            btn.innerHTML = 'üîä Speakers Work!';
            btn.style.background = 'linear-gradient(135deg, #27ae60, #2ecc71)';
            
            setTimeout(() => {
                btn.innerHTML = 'üîä Force Speaker';
                btn.style.background = 'linear-gradient(135deg, #4a90e2, #2c5aa0)';
                btn.disabled = false;
            }, 3000);
        }

        function testMicrophone() {
            const btn = event.target;
            btn.innerHTML = 'üé§ Testing...';
            btn.disabled = true;
            
            navigator.mediaDevices.getUserMedia({ audio: true })
                .then(function(stream) {
                    btn.innerHTML = 'üé§ Mic Works!';
                    btn.style.background = 'linear-gradient(135deg, #27ae60, #2ecc71)';
                    
                    // Test recording for 3 seconds
                    setTimeout(() => {
                        stream.getTracks().forEach(track => track.stop());
                        btn.innerHTML = 'üé§ Test Mic';
                        btn.style.background = 'linear-gradient(135deg, #4a90e2, #2c5aa0)';
                        btn.disabled = false;
                    }, 3000);
                })
                .catch(function(error) {
                    btn.innerHTML = 'üé§ Mic Error';
                    btn.style.background = 'linear-gradient(135deg, #e74c3c, #c0392b)';
                    
                    setTimeout(() => {
                        btn.innerHTML = 'üé§ Test Mic';
                        btn.style.background = 'linear-gradient(135deg, #4a90e2, #2c5aa0)';
                        btn.disabled = false;
                    }, 3000);
                });
        }

        function testForcedVoice() {
            const btn = event.target;
            btn.innerHTML = 'üó£Ô∏è Testing...';
            btn.disabled = true;
            
            forcedSpeak("Forced voice test successful! I am speaking directly from the cosmic portal using advanced speech synthesis. The voice system is working perfectly!");
            
            btn.innerHTML = 'üó£Ô∏è Voice Works!';
            btn.style.background = 'linear-gradient(135deg, #27ae60, #2ecc71)';
            
            setTimeout(() => {
                btn.innerHTML = 'üó£Ô∏è Test Voice';
                btn.style.background = 'linear-gradient(135deg, #4a90e2, #2c5aa0)';
                btn.disabled = false;
            }, 5000);
        }

        function restartVoiceSystem() {
            const btn = event.target;
            btn.innerHTML = 'üîÑ Restarting...';
            btn.disabled = true;
            
            // Stop current system
            stopForcedVoiceMode();
            
            // Reinitialize
            setTimeout(() => {
                initializeForcedVoiceSystem();
                
                setTimeout(() => {
                    forcedSpeak("Voice system restarted successfully! All systems are operational.");
                    btn.innerHTML = 'üîÑ Restart Voice';
                    btn.style.background = 'linear-gradient(135deg, #4a90e2, #2c5aa0)';
                    btn.disabled = false;
                }, 1000);
            }, 1000);
        }

        // Close settings panel when clicking outside
        document.addEventListener('click', function(event) {
            const settingsPanel = document.getElementById('settingsPanel');
            const settingsBtn = document.getElementById('settingsBtn');
            
            if (settingsPanel && settingsBtn && 
                !settingsPanel.contains(event.target) && 
                !settingsBtn.contains(event.target)) {
                settingsPanel.classList.remove('show');
            }
        });

        // Initialize voice system when page loads
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Voice system ready for activation');
        });
    </script>
</body>
</html>
