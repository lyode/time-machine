<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Renovation Pro - Persistent Data</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #2d3748;
            overflow-x: hidden;
        }

        .app-container {
            max-width: 100%;
            min-height: 100vh;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 20px 16px;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .header h1 {
            font-size: 24px;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 8px;
        }

        .header p {
            color: #718096;
            font-size: 14px;
        }

        .data-status {
            position: absolute;
            top: 16px;
            right: 16px;
            background: rgba(72, 187, 120, 0.9);
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }

        .tab-navigation {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            display: flex;
            padding: 8px;
            position: sticky;
            top: 80px;
            z-index: 99;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            overflow-x: auto;
        }

        .tab-btn {
            flex: 1;
            padding: 12px 8px;
            border: none;
            background: transparent;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #718096;
            text-align: center;
            white-space: nowrap;
            min-width: 80px;
        }

        .tab-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .content-container {
            padding: 16px;
            padding-bottom: 100px;
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 16px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .section-title {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 16px;
            color: #2d3748;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 16px;
        }

        @media (min-width: 640px) {
            .form-grid {
                grid-template-columns: 1fr 1fr;
            }
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        .form-label {
            font-weight: 600;
            margin-bottom: 8px;
            color: #4a5568;
            font-size: 14px;
        }

        .form-input,
        .form-select,
        .form-textarea {
            padding: 14px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: white;
        }

        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            transform: translateY(-2px);
        }

        .form-textarea {
            resize: vertical;
            min-height: 80px;
        }

        .btn {
            padding: 14px 24px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            min-height: 50px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-primary:hover,
        .btn-primary:active {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.6);
        }

        .btn-secondary {
            background: #f7fafc;
            color: #4a5568;
            border: 2px solid #e2e8f0;
        }

        .btn-success {
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
            color: white;
        }

        .btn-warning {
            background: linear-gradient(135deg, #ed8936 0%, #dd6b20 100%);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(135deg, #f56565 0%, #e53e3e 100%);
            color: white;
        }

        .btn-full {
            width: 100%;
            margin-bottom: 12px;
        }

        .btn-small {
            padding: 8px 12px;
            font-size: 14px;
            min-height: 36px;
        }

        .renovation-categories {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 12px;
            margin-bottom: 20px;
        }

        .category-btn {
            padding: 16px 12px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-size: 14px;
            font-weight: 600;
            color: #4a5568;
        }

        .category-btn:hover,
        .category-btn:active {
            border-color: #667eea;
            background: #f8fafc;
            transform: scale(1.02);
        }

        .category-btn.selected {
            border-color: #667eea;
            background: #e6fffa;
            color: #2d3748;
        }

        .items-container {
            margin-top: 20px;
        }

        .item-row {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr auto;
            gap: 8px;
            margin-bottom: 12px;
            align-items: end;
            padding: 12px;
            background: #f8fafc;
            border-radius: 12px;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .item-row:hover {
            border-color: #e2e8f0;
            background: white;
        }

        .item-input {
            padding: 10px 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            background: white;
        }

        .item-input:focus {
            outline: none;
            border-color: #667eea;
        }

        .remove-btn {
            background: #fed7d7;
            color: #c53030;
            border: none;
            padding: 10px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            min-height: 40px;
            min-width: 40px;
        }

        .add-item-btn {
            width: 100%;
            padding: 12px;
            border: 2px dashed #cbd5e1;
            border-radius: 12px;
            background: transparent;
            color: #667eea;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .add-item-btn:hover {
            border-color: #667eea;
            background: #f8fafc;
        }

        .totals-section {
            background: #f8fafc;
            padding: 20px;
            border-radius: 12px;
            margin-top: 20px;
            border-left: 4px solid #667eea;
        }

        .total-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 16px;
        }

        .total-row.grand-total {
            font-weight: 700;
            font-size: 20px;
            padding-top: 12px;
            border-top: 2px solid #cbd5e1;
            color: #667eea;
        }

        .quote-preview {
            background: white;
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 16px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            max-height: 600px;
            overflow-y: auto;
        }

        .quote-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid #667eea;
        }

        .company-logo {
            font-size: 32px;
            margin-bottom: 12px;
        }

        .quote-title {
            font-size: 28px;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 8px;
        }

        .quote-subtitle {
            color: #718096;
            font-size: 16px;
        }

        .quote-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        @media (max-width: 640px) {
            .quote-info {
                grid-template-columns: 1fr;
            }
        }

        .info-section {
            background: #f8fafc;
            padding: 16px;
            border-radius: 12px;
            border-left: 4px solid #667eea;
        }

        .info-title {
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 8px;
        }

        .quote-items {
            margin: 30px 0;
        }

        .items-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .items-table th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 16px 12px;
            text-align: left;
            font-weight: 600;
            font-size: 14px;
        }

        .items-table td {
            padding: 12px;
            border-bottom: 1px solid #e2e8f0;
            vertical-align: top;
        }

        .items-table tr:last-child td {
            border-bottom: none;
        }

        .items-table tr:nth-child(even) {
            background: #f8fafc;
        }

        .category-header {
            background: #edf2f7;
            font-weight: 700;
            color: #4a5568;
            font-style: italic;
        }

        .category-header td {
            padding: 12px;
            border-top: 2px solid #cbd5e1;
        }

        .floating-actions {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 16px;
            box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.1);
            z-index: 1000;
        }

        .action-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 8px;
        }

        .notification {
            position: fixed;
            top: 100px;
            left: 16px;
            right: 16px;
            padding: 16px 20px;
            background: #48bb78;
            color: white;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            transform: translateY(-100px);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 2000;
            text-align: center;
        }

        .notification.show {
            transform: translateY(0);
            opacity: 1;
        }

        .notification.error {
            background: #f56565;
        }

        .notification.warning {
            background: #ed8936;
        }

        .saved-quotes {
            display: grid;
            gap: 12px;
        }

        .quote-card {
            background: white;
            padding: 16px;
            border-radius: 12px;
            border-left: 4px solid #667eea;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .quote-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }

        .quote-card-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 8px;
        }

        .quote-card-title {
            font-weight: 700;
            color: #2d3748;
        }

        .quote-card-amount {
            font-weight: 700;
            color: #667eea;
            font-size: 18px;
        }

        .quote-card-details {
            color: #718096;
            font-size: 14px;
        }

        .quote-card-actions {
            display: flex;
            gap: 8px;
            margin-top: 12px;
        }

        .card-action-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .settings-grid {
            display: grid;
            gap: 16px;
        }

        .setting-item {
            background: #f8fafc;
            padding: 16px;
            border-radius: 12px;
            border-left: 4px solid #667eea;
        }

        .setting-title {
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 8px;
        }

        .setting-description {
            color: #718096;
            font-size: 14px;
            margin-bottom: 12px;
        }

        .data-manager {
            display: grid;
            gap: 12px;
        }

        .data-info {
            background: #e6fffa;
            border: 2px solid #4fd1c7;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 16px;
        }

        .data-info h4 {
            color: #2d3748;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .data-info p {
            color: #4a5568;
            font-size: 14px;
        }

        .storage-stats {
            background: #f8fafc;
            padding: 12px;
            border-radius: 8px;
            font-family: monospace;
            font-size: 12px;
            color: #4a5568;
            margin-top: 8px;
        }

        @media (max-width: 640px) {
            .header {
                padding: 16px;
            }

            .header h1 {
                font-size: 20px;
            }

            .content-container {
                padding: 12px;
            }

            .item-row {
                grid-template-columns: 1fr;
                gap: 8px;
                text-align: left;
            }

            .action-buttons {
                grid-template-columns: 1fr;
                gap: 8px;
            }

            .quote-info {
                grid-template-columns: 1fr;
            }

            .renovation-categories {
                grid-template-columns: 1fr 1fr;
            }

            .data-status {
                position: relative;
                top: auto;
                right: auto;
                margin-top: 8px;
                display: inline-block;
            }
        }

        @media print {
            body {
                background: white;
                color: black;
            }

            .header,
            .tab-navigation,
            .floating-actions {
                display: none;
            }

            .content-container {
                padding: 0;
            }

            .tab-content {
                display: none;
            }

            .tab-content.active {
                display: block;
            }

            .quote-preview {
                box-shadow: none;
                border-radius: 0;
                max-height: none;
                overflow: visible;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <header class="header">
            <h1>üèóÔ∏è Renovation Pro</h1>
            <p>Professional quotations with persistent data storage</p>
            <div class="data-status" id="dataStatus">üíæ Data Saved</div>
        </header>

        <nav class="tab-navigation">
            <button class="tab-btn active" onclick="switchTab('customer')">üë§ Customer</button>
            <button class="tab-btn" onclick="switchTab('project')">üè† Project</button>
            <button class="tab-btn" onclick="switchTab('quote')">üìã Quote</button>
            <button class="tab-btn" onclick="switchTab('saved')">üíæ Saved</button>
            <button class="tab-btn" onclick="switchTab('settings')">‚öôÔ∏è Settings</button>
        </nav>

        <div class="content-container">
            <!-- Customer Details Tab -->
            <div id="customer" class="tab-content active">
                <div class="card">
                    <h2 class="section-title">üë§ Customer Information</h2>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label" for="customerName">Customer Name *</label>
                            <input type="text" id="customerName" class="form-input" placeholder="John & Jane Smith">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="customerPhone">Phone Number</label>
                            <input type="tel" id="customerPhone" class="form-input" placeholder="+1 (555) 123-4567">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="customerEmail">Email Address</label>
                            <input type="email" id="customerEmail" class="form-input" placeholder="john.smith@email.com">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="projectDate">Project Start Date</label>
                            <input type="date" id="projectDate" class="form-input">
                        </div>
                        <div class="form-group full-width">
                            <label class="form-label" for="propertyAddress">Property Address</label>
                            <textarea id="propertyAddress" class="form-textarea" placeholder="123 Main Street, City, State, ZIP Code"></textarea>
                        </div>
                        <div class="form-group full-width">
                            <label class="form-label" for="projectDescription">Project Description</label>
                            <textarea id="projectDescription" class="form-textarea" placeholder="Brief description of the renovation project..."></textarea>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Project Details Tab -->
            <div id="project" class="tab-content">
                <div class="card">
                    <h2 class="section-title">üè† Renovation Categories</h2>
                    <div class="renovation-categories">
                        <div class="category-btn" onclick="selectCategory('kitchen')" data-category="kitchen">
                            <div>üç≥</div>
                            <div>Kitchen</div>
                        </div>
                        <div class="category-btn" onclick="selectCategory('bathroom')" data-category="bathroom">
                            <div>üõÅ</div>
                            <div>Bathroom</div>
                        </div>
                        <div class="category-btn" onclick="selectCategory('living')" data-category="living">
                            <div>üõãÔ∏è</div>
                            <div>Living Room</div>
                        </div>
                        <div class="category-btn" onclick="selectCategory('bedroom')" data-category="bedroom">
                            <div>üõèÔ∏è</div>
                            <div>Bedroom</div>
                        </div>
                        <div class="category-btn" onclick="selectCategory('flooring')" data-category="flooring">
                            <div>üè†</div>
                            <div>Flooring</div>
                        </div>
                        <div class="category-btn" onclick="selectCategory('exterior')" data-category="exterior">
                            <div>üè°</div>
                            <div>Exterior</div>
                        </div>
                        <div class="category-btn" onclick="selectCategory('electrical')" data-category="electrical">
                            <div>‚ö°</div>
                            <div>Electrical</div>
                        </div>
                        <div class="category-btn" onclick="selectCategory('plumbing')" data-category="plumbing">
                            <div>üîß</div>
                            <div>Plumbing</div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h2 class="section-title">üìù Project Items</h2>
                    <div class="items-container" id="itemsContainer">
                        <!-- Items will be added dynamically -->
                    </div>
                    <button class="add-item-btn" onclick="addItem()">
                        ‚ûï Add Item
                    </button>
                </div>

                <div class="card">
                    <h2 class="section-title">üí∞ Project Totals</h2>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label" for="discountPercent">Discount (%)</label>
                            <input type="number" id="discountPercent" class="form-input" placeholder="0" min="0" max="100" step="0.1">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="taxPercent">Tax (%)</label>
                            <input type="number" id="taxPercent" class="form-input" placeholder="8.5" min="0" max="100" step="0.1">
                        </div>
                    </div>
                    <div class="totals-section" id="totalsSection">
                        <div class="total-row">
                            <span>Subtotal:</span>
                            <span id="subtotal">$0.00</span>
                        </div>
                        <div class="total-row">
                            <span>Discount:</span>
                            <span id="discount">$0.00</span>
                        </div>
                        <div class="total-row">
                            <span>Tax:</span>
                            <span id="tax">$0.00</span>
                        </div>
                        <div class="total-row grand-total">
                            <span>Total:</span>
                            <span id="grandTotal">$0.00</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quote Preview Tab -->
            <div id="quote" class="tab-content">
                <div class="quote-preview">
                    <div class="quote-header">
                        <div class="company-logo">üèóÔ∏è</div>
                        <h1 class="quote-title">RENOVATION QUOTATION</h1>
                        <p class="quote-subtitle">Professional Renovation Services</p>
                    </div>

                    <div class="quote-info">
                        <div class="info-section">
                            <div class="info-title">Company Information</div>
                            <div id="quoteCompanyInfo">
                                <p><strong id="quoteCompanyName">Elite Renovation Solutions</strong></p>
                                <p id="quoteCompanyAddress">456 Business Avenue, Suite 200<br>Springfield, IL 62701</p>
                                <p>Phone: <span id="quoteCompanyPhone">+1 (555) 987-6543</span></p>
                                <p>Email: <span id="quoteCompanyEmail">info@eliterenovation.com</span></p>
                                <p>License: <span id="quoteLicenseNumber">LIC-789456</span></p>
                            </div>
                        </div>

                        <div class="info-section">
                            <div class="info-title">Customer Information</div>
                            <div id="quoteCustomerInfo">
                                <p><strong id="quoteCustomerName">[Customer Name]</strong></p>
                                <p id="quotePropertyAddress">[Property Address]</p>
                                <p>Phone: <span id="quoteCustomerPhone">[Phone]</span></p>
                                <p>Email: <span id="quoteCustomerEmail">[Email]</span></p>
                                <p>Project Date: <span id="quoteProjectDate">[Date]</span></p>
                            </div>
                        </div>
                    </div>

                    <div class="info-section" style="margin-bottom: 20px;">
                        <div class="info-title">Project Description</div>
                        <p id="quoteProjectDescription">[Project Description]</p>
                    </div>

                    <div class="quote-items">
                        <table class="items-table" id="quoteItemsTable">
                            <thead>
                                <tr>
                                    <th>Description</th>
                                    <th>Qty</th>
                                    <th>Unit Price</th>
                                    <th>Total</th>
                                </tr>
                            </thead>
                            <tbody id="quoteItemsBody">
                                <!-- Items will be populated here -->
                            </tbody>
                        </table>
                    </div>

                    <div class="totals-section">
                        <div class="total-row">
                            <span>Subtotal:</span>
                            <span id="quoteSubtotal">$0.00</span>
                        </div>
                        <div class="total-row">
                            <span>Discount (<span id="quoteDiscountPercent">0</span>%):</span>
                            <span id="quoteDiscount">$0.00</span>
                        </div>
                        <div class="total-row">
                            <span>Tax (<span id="quoteTaxPercent">8.5</span>%):</span>
                            <span id="quoteTax">$0.00</span>
                        </div>
                        <div class="total-row grand-total">
                            <span>TOTAL:</span>
                            <span id="quoteGrandTotal">$0.00</span>
                        </div>
                    </div>

                    <div style="margin-top: 30px; padding: 20px; background: #f8fafc; border-radius: 12px; border-left: 4px solid #667eea;">
                        <h3 style="margin-bottom: 12px; color: #2d3748;">Terms & Conditions</h3>
                        <div id="quoteTerms">
                            <ul style="color: #4a5568; font-size: 14px; line-height: 1.6;">
                                <li>Quote valid for 30 days from date issued</li>
                                <li>50% deposit required to begin work</li>
                                <li>Final payment due upon completion</li>
                                <li>All materials and labor included unless specified</li>
                                <li>Changes to scope may affect final price</li>
                                <li>Work guaranteed for 1 year from completion</li>
                            </ul>
                        </div>
                    </div>

                    <div style="margin-top: 30px; text-align: center; border-top: 2px solid #e2e8f0; padding-top: 20px;">
                        <p style="color: #718096; font-size: 14px;">
                            Thank you for choosing our renovation services!<br>
                            Quote generated on: <span id="quoteDate"></span>
                        </p>
                    </div>
                </div>
            </div>

            <!-- Saved Quotes Tab -->
            <div id="saved" class="tab-content">
                <div class="card">
                    <h2 class="section-title">üíæ Saved Quotations</h2>
                    <div class="saved-quotes" id="savedQuotes">
                        <!-- Saved quotes will be displayed here -->
                    </div>
                </div>
            </div>

            <!-- Settings Tab -->
            <div id="settings" class="tab-content">
                <div class="card">
                    <h2 class="section-title">üè¢ Company Settings</h2>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label" for="settingsCompanyName">Company Name</label>
                            <input type="text" id="settingsCompanyName" class="form-input" placeholder="Your Company Name">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="settingsCompanyPhone">Company Phone</label>
                            <input type="tel" id="settingsCompanyPhone" class="form-input" placeholder="+1 (555) 987-6543">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="settingsCompanyEmail">Company Email</label>
                            <input type="email" id="settingsCompanyEmail" class="form-input" placeholder="info@company.com">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="settingsLicenseNumber">License Number</label>
                            <input type="text" id="settingsLicenseNumber" class="form-input" placeholder="LIC-123456">
                        </div>
                        <div class="form-group full-width">
                            <label class="form-label" for="settingsCompanyAddress">Company Address</label>
                            <textarea id="settingsCompanyAddress" class="form-textarea" placeholder="Company address..."></textarea>
                        </div>
                    </div>
                    <button class="btn btn-primary btn-full" onclick="saveCompanySettings()">
                        üíæ Save Company Settings
                    </button>
                </div>

                <div class="card">
                    <h2 class="section-title">üìã Default Settings</h2>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label" for="defaultTaxRate">Default Tax Rate (%)</label>
                            <input type="number" id="defaultTaxRate" class="form-input" placeholder="8.5" min="0" max="100" step="0.1">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="defaultDiscount">Default Discount (%)</label>
                            <input type="number" id="defaultDiscount" class="form-input" placeholder="0" min="0" max="100" step="0.1">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="quoteValidDays">Quote Valid Days</label>
                            <input type="number" id="quoteValidDays" class="form-input" placeholder="30" min="1" max="365">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="depositPercent">Deposit Percentage (%)</label>
                            <input type="number" id="depositPercent" class="form-input" placeholder="50" min="0" max="100">
                        </div>
                        <div class="form-group full-width">
                            <label class="form-label" for="customTerms">Custom Terms & Conditions</label>
                            <textarea id="customTerms" class="form-textarea" rows="6" placeholder="Enter your custom terms and conditions..."></textarea>
                        </div>
                    </div>
                    <button class="btn btn-success btn-full" onclick="saveDefaultSettings()">
                        ‚öôÔ∏è Save Default Settings
                    </button>
                </div>

                <div class="card">
                    <h2 class="section-title">üíæ Data Management</h2>
                    
                    <div class="data-info">
                        <h4>üìä Storage Information</h4>
                        <p>Your data is automatically saved to your device's local storage. This ensures your company information, quotes, and settings persist even after browser refreshes.</p>
                        <div class="storage-stats" id="storageStats">
                            Loading storage statistics...
                        </div>
                    </div>

                    <div class="data-manager">
                        <button class="btn btn-primary btn-full" onclick="exportData()">
                            üì§ Export All Data
                        </button>
                        <button class="btn btn-warning btn-full" onclick="importData()">
                            üì• Import Data
                        </button>
                        <button class="btn btn-secondary btn-full" onclick="clearCurrentQuote()">
                            üóëÔ∏è Clear Current Quote
                        </button>
                        <button class="btn btn-danger btn-full" onclick="resetAllData()">
                            ‚ö†Ô∏è Reset All Data
                        </button>
                    </div>
                    
                    <input type="file" id="importFile" accept=".json" style="display: none;" onchange="handleImportFile(event)">
                </div>

                <div class="card">
                    <h2 class="section-title">‚ÑπÔ∏è About</h2>
                    <div class="setting-item">
                        <div class="setting-title">Renovation Pro v2.0</div>
                        <div class="setting-description">
                            Professional renovation quotation app with persistent local storage. 
                            All your data is saved locally and will persist across browser sessions.
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="floating-actions">
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="generateQuote()">
                    üìù Generate
                </button>
                <button class="btn btn-success" onclick="saveQuote()">
                    üíæ Save Quote
                </button>
                <button class="btn btn-warning" onclick="printQuote()">
                    üñ®Ô∏è Print
                </button>
            </div>
        </div>
    </div>

    <div id="notification" class="notification"></div>

    <script>
        // Global variables
        let currentTab = 'customer';
        let projectItems = [];
        let currentCategory = '';
        let autoSaveInterval;

        // Storage keys
        const STORAGE_KEYS = {
            COMPANY_SETTINGS: 'renovationPro_companySettings',
            DEFAULT_SETTINGS: 'renovationPro_defaultSettings',
            CURRENT_QUOTE: 'renovationPro_currentQuote',
            SAVED_QUOTES: 'renovationPro_savedQuotes',
            USER_PREFERENCES: 'renovationPro_userPreferences'
        };

        // Default company settings
        const DEFAULT_COMPANY = {
            name: 'Elite Renovation Solutions',
            phone: '+1 (555) 987-6543',
            email: 'info@eliterenovation.com',
            address: '456 Business Avenue, Suite 200\nSpringfield, IL 62701',
            license: 'LIC-789456'
        };

        // Default app settings
        const DEFAULT_SETTINGS = {
            taxRate: 8.5,
            discount: 0,
            quoteValidDays: 30,
            depositPercent: 50,
            terms: `‚Ä¢ Quote valid for 30 days from date issued
‚Ä¢ 50% deposit required to begin work
‚Ä¢ Final payment due upon completion
‚Ä¢ All materials and labor included unless specified
‚Ä¢ Changes to scope may affect final price
‚Ä¢ Work guaranteed for 1 year from completion`
        };

        // Data persistence manager
        class DataManager {
            static save(key, data) {
                try {
                    localStorage.setItem(key, JSON.stringify(data));
                    this.updateDataStatus('saved');
                    return true;
                } catch (error) {
                    console.error('Failed to save data:', error);
                    this.updateDataStatus('error');
                    return false;
                }
            }

            static load(key, defaultValue = null) {
                try {
                    const item = localStorage.getItem(key);
                    return item ? JSON.parse(item) : defaultValue;
                } catch (error) {
                    console.error('Failed to load data:', error);
                    return defaultValue;
                }
            }

            static remove(key) {
                try {
                    localStorage.removeItem(key);
                    return true;
                } catch (error) {
                    console.error('Failed to remove data:', error);
                    return false;
                }
            }

            static clear() {
                try {
                    Object.values(STORAGE_KEYS).forEach(key => {
                        localStorage.removeItem(key);
                    });
                    return true;
                } catch (error) {
                    console.error('Failed to clear data:', error);
                    return false;
                }
            }

            static getStorageStats() {
                let totalSize = 0;
                const stats = {};
                
                Object.entries(STORAGE_KEYS).forEach(([name, key]) => {
                    const item = localStorage.getItem(key);
                    const size = item ? new Blob([item]).size : 0;
                    stats[name] = {
                        size: size,
                        sizeKB: (size / 1024).toFixed(2),
                        exists: !!item
                    };
                    totalSize += size;
                });

                return {
                    individual: stats,
                    total: totalSize,
                    totalKB: (totalSize / 1024).toFixed(2),
                    totalMB: (totalSize / 1024 / 1024).toFixed(2)
                };
            }

            static updateDataStatus(status) {
                const statusElement = document.getElementById('dataStatus');
                if (!statusElement) return;

                switch (status) {
                    case 'saved':
                        statusElement.textContent = 'üíæ Data Saved';
                        statusElement.style.background = 'rgba(72, 187, 120, 0.9)';
                        break;
                    case 'loading':
                        statusElement.textContent = 'üìÅ Loading...';
                        statusElement.style.background = 'rgba(237, 137, 54, 0.9)';
                        break;
                    case 'error':
                        statusElement.textContent = '‚ö†Ô∏è Save Error';
                        statusElement.style.background = 'rgba(245, 101, 101, 0.9)';
                        break;
                    default:
                        statusElement.textContent = 'üíæ Data Saved';
                        statusElement.style.background = 'rgba(72, 187, 120, 0.9)';
                }
            }
        }

        // Notification system
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type} show`;
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Tab management
        function switchTab(tabName) {
            // Update tab buttons
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            // Update tab content
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            document.getElementById(tabName).classList.add('active');

            currentTab = tabName;

            // Load specific tab data
            if (tabName === 'quote') {
                updateQuote();
            } else if (tabName === 'saved') {
                displaySavedQuotes();
            } else if (tabName === 'settings') {
                loadSettingsTab();
            }
        }

        // Auto-save functionality
        function startAutoSave() {
            if (autoSaveInterval) {
                clearInterval(autoSaveInterval);
            }
            
            autoSaveInterval = setInterval(() => {
                saveCurrentQuote();
            }, 10000); // Auto-save every 10 seconds
        }

        function saveCurrentQuote() {
            const currentQuoteData = {
                customerName: document.getElementById('customerName').value,
                customerPhone: document.getElementById('customerPhone').value,
                customerEmail: document.getElementById('customerEmail').value,
                propertyAddress: document.getElementById('propertyAddress').value,
                projectDescription: document.getElementById('projectDescription').value,
                projectDate: document.getElementById('projectDate').value,
                discountPercent: document.getElementById('discountPercent').value,
                taxPercent: document.getElementById('taxPercent').value,
                items: [...projectItems],
                lastSaved: new Date().toISOString()
            };

            DataManager.save(STORAGE_KEYS.CURRENT_QUOTE, currentQuoteData);
        }

        function loadCurrentQuote() {
            DataManager.updateDataStatus('loading');
            
            const savedQuote = DataManager.load(STORAGE_KEYS.CURRENT_QUOTE);
            if (savedQuote) {
                // Load customer data
                document.getElementById('customerName').value = savedQuote.customerName || '';
                document.getElementById('customerPhone').value = savedQuote.customerPhone || '';
                document.getElementById('customerEmail').value = savedQuote.customerEmail || '';
                document.getElementById('propertyAddress').value = savedQuote.propertyAddress || '';
                document.getElementById('projectDescription').value = savedQuote.projectDescription || '';
                document.getElementById('projectDate').value = savedQuote.projectDate || '';
                document.getElementById('discountPercent').value = savedQuote.discountPercent || '';
                document.getElementById('taxPercent').value = savedQuote.taxPercent || '';

                // Load items
                if (savedQuote.items && savedQuote.items.length > 0) {
                    projectItems = [...savedQuote.items];
                    refreshItemsContainer();
                }

                showNotification('üìÅ Previous work loaded successfully!');
            }
            
            DataManager.updateDataStatus('saved');
        }

        // Company settings management
        function saveCompanySettings() {
            const companySettings = {
                name: document.getElementById('settingsCompanyName').value,
                phone: document.getElementById('settingsCompanyPhone').value,
                email: document.getElementById('settingsCompanyEmail').value,
                address: document.getElementById('settingsCompanyAddress').value,
                license: document.getElementById('settingsLicenseNumber').value,
                lastUpdated: new Date().toISOString()
            };

            if (DataManager.save(STORAGE_KEYS.COMPANY_SETTINGS, companySettings)) {
                showNotification('üè¢ Company settings saved successfully!');
                updateQuote(); // Refresh quote with new company info
            } else {
                showNotification('Failed to save company settings', 'error');
            }
        }

        function loadCompanySettings() {
            const settings = DataManager.load(STORAGE_KEYS.COMPANY_SETTINGS, DEFAULT_COMPANY);
            
            document.getElementById('settingsCompanyName').value = settings.name || '';
            document.getElementById('settingsCompanyPhone').value = settings.phone || '';
            document.getElementById('settingsCompanyEmail').value = settings.email || '';
            document.getElementById('settingsCompanyAddress').value = settings.address || '';
            document.getElementById('settingsLicenseNumber').value = settings.license || '';

            return settings;
        }

        // Default settings management
        function saveDefaultSettings() {
            const defaultSettings = {
                taxRate: parseFloat(document.getElementById('defaultTaxRate').value) || 0,
                discount: parseFloat(document.getElementById('defaultDiscount').value) || 0,
                quoteValidDays: parseInt(document.getElementById('quoteValidDays').value) || 30,
                depositPercent: parseInt(document.getElementById('depositPercent').value) || 50,
                terms: document.getElementById('customTerms').value || DEFAULT_SETTINGS.terms,
                lastUpdated: new Date().toISOString()
            };

            if (DataManager.save(STORAGE_KEYS.DEFAULT_SETTINGS, defaultSettings)) {
                showNotification('‚öôÔ∏è Default settings saved successfully!');
                
                // Apply to current quote
                document.getElementById('taxPercent').value = defaultSettings.taxRate;
                document.getElementById('discountPercent').value = defaultSettings.discount;
                calculateTotals();
            } else {
                showNotification('Failed to save default settings', 'error');
            }
        }

        function loadDefaultSettings() {
            const settings = DataManager.load(STORAGE_KEYS.DEFAULT_SETTINGS, DEFAULT_SETTINGS);
            
            document.getElementById('defaultTaxRate').value = settings.taxRate || '';
            document.getElementById('defaultDiscount').value = settings.discount || '';
            document.getElementById('quoteValidDays').value = settings.quoteValidDays || '';
            document.getElementById('depositPercent').value = settings.depositPercent || '';
            document.getElementById('customTerms').value = settings.terms || '';

            // Apply to current form if empty
            if (!document.getElementById('taxPercent').value) {
                document.getElementById('taxPercent').value = settings.taxRate || 8.5;
            }
            if (!document.getElementById('discountPercent').value) {
                document.getElementById('discountPercent').value = settings.discount || 0;
            }

            return settings;
        }

        function loadSettingsTab() {
            loadCompanySettings();
            loadDefaultSettings();
            updateStorageStats();
        }

        function updateStorageStats() {
            const stats = DataManager.getStorageStats();
            const statsElement = document.getElementById('storageStats');
            
            if (statsElement) {
                statsElement.innerHTML = `
Total Storage Used: ${stats.totalKB} KB (${stats.totalMB} MB)

Breakdown:
- Company Settings: ${stats.individual.COMPANY_SETTINGS.sizeKB} KB
- Default Settings: ${stats.individual.DEFAULT_SETTINGS.sizeKB} KB  
- Current Quote: ${stats.individual.CURRENT_QUOTE.sizeKB} KB
- Saved Quotes: ${stats.individual.SAVED_QUOTES.sizeKB} KB
- User Preferences: ${stats.individual.USER_PREFERENCES.sizeKB} KB

Last Updated: ${new Date().toLocaleString()}
                `;
            }
        }

        // Category and item management
        function selectCategory(category) {
            currentCategory = category;
            
            // Update category button styles
            document.querySelectorAll('.category-btn').forEach(btn => btn.classList.remove('selected'));
            document.querySelector(`[data-category="${category}"]`).classList.add('selected');

            showNotification(`${category.charAt(0).toUpperCase() + category.slice(1)} category selected`);
        }

        function addItem(preset = null) {
            const container = document.getElementById('itemsContainer');
            const itemIndex = projectItems.length;
            
            const itemData = preset || {
                description: '',
                category: currentCategory || 'general',
                quantity: 1,
                unit: 'each',
                materialCost: 0,
                laborCost: 0
            };

            projectItems.push(itemData);

            const itemRow = document.createElement('div');
            itemRow.className = 'item-row';
            itemRow.innerHTML = `
                <input type="text" class="item-input" placeholder="Item description" 
                       value="${itemData.description}" 
                       onchange="updateItem(${itemIndex}, 'description', this.value)">
                <input type="number" class="item-input" placeholder="Qty" min="1" 
                       value="${itemData.quantity}" 
                       onchange="updateItem(${itemIndex}, 'quantity', this.value)">
                <input type="text" class="item-input" placeholder="Unit" 
                       value="${itemData.unit}" 
                       onchange="updateItem(${itemIndex}, 'unit', this.value)">
                <input type="number" class="item-input" placeholder="Unit Price" min="0" step="0.01" 
                       value="${itemData.materialCost + itemData.laborCost}" 
                       onchange="updateItem(${itemIndex}, 'totalCost', this.value)">
                <button class="remove-btn" onclick="removeItem(${itemIndex})">üóëÔ∏è</button>
            `;

            container.appendChild(itemRow);
            calculateTotals();
            saveCurrentQuote(); // Auto-save when items change
        }

        function updateItem(index, field, value) {
            if (field === 'totalCost') {
                projectItems[index].materialCost = parseFloat(value) * 0.6 || 0;
                projectItems[index].laborCost = parseFloat(value) * 0.4 || 0;
            } else {
                projectItems[index][field] = isNaN(value) ? value : parseFloat(value) || value;
            }
            calculateTotals();
            saveCurrentQuote(); // Auto-save on changes
        }

        function removeItem(index) {
            projectItems.splice(index, 1);
            refreshItemsContainer();
            calculateTotals();
            saveCurrentQuote(); // Auto-save when items change
        }

        function refreshItemsContainer() {
            const container = document.getElementById('itemsContainer');
            container.innerHTML = '';
            const tempItems = [...projectItems];
            projectItems = [];
            tempItems.forEach(item => addItem(item));
        }

        // Calculations
        function calculateTotals() {
            const subtotal = projectItems.reduce((sum, item) => {
                return sum + ((item.materialCost + item.laborCost) * item.quantity);
            }, 0);

            const discountPercent = parseFloat(document.getElementById('discountPercent').value) || 0;
            const taxPercent = parseFloat(document.getElementById('taxPercent').value) || 0;

            const discountAmount = subtotal * (discountPercent / 100);
            const afterDiscount = subtotal - discountAmount;
            const taxAmount = afterDiscount * (taxPercent / 100);
            const grandTotal = afterDiscount + taxAmount;

            document.getElementById('subtotal').textContent = formatCurrency(subtotal);
            document.getElementById('discount').textContent = formatCurrency(discountAmount);
            document.getElementById('tax').textContent = formatCurrency(taxAmount);
            document.getElementById('grandTotal').textContent = formatCurrency(grandTotal);

            updateQuote();
        }

        function formatCurrency(amount) {
            return new Intl.NumberFormat('en-US', {
                style: 'currency',
                currency: 'USD',
                minimumFractionDigits: 2
            }).format(amount || 0);
        }

        // Quote management
        function updateQuote() {
            // Load company settings
            const companySettings = DataManager.load(STORAGE_KEYS.COMPANY_SETTINGS, DEFAULT_COMPANY);
            
            // Update company info
            document.getElementById('quoteCompanyName').textContent = companySettings.name;
            document.getElementById('quoteCompanyAddress').innerHTML = companySettings.address.replace(/\n/g, '<br>');
            document.getElementById('quoteCompanyPhone').textContent = companySettings.phone;
            document.getElementById('quoteCompanyEmail').textContent = companySettings.email;
            document.getElementById('quoteLicenseNumber').textContent = companySettings.license;

            // Update customer info
            document.getElementById('quoteCustomerName').textContent = 
                document.getElementById('customerName').value || '[Customer Name]';
            document.getElementById('quotePropertyAddress').innerHTML = 
                (document.getElementById('propertyAddress').value || '[Property Address]').replace(/\n/g, '<br>');
            document.getElementById('quoteCustomerPhone').textContent = 
                document.getElementById('customerPhone').value || '[Phone]';
            document.getElementById('quoteCustomerEmail').textContent = 
                document.getElementById('customerEmail').value || '[Email]';
            document.getElementById('quoteProjectDate').textContent = 
                document.getElementById('projectDate').value || '[Date]';
            document.getElementById('quoteProjectDescription').textContent = 
                document.getElementById('projectDescription').value || '[Project Description]';

            // Update items table
            const tbody = document.getElementById('quoteItemsBody');
            tbody.innerHTML = '';

            const itemsByCategory = {};
            projectItems.forEach(item => {
                if (!itemsByCategory[item.category]) {
                    itemsByCategory[item.category] = [];
                }
                itemsByCategory[item.category].push(item);
            });

            Object.entries(itemsByCategory).forEach(([category, items]) => {
                // Category header
                const categoryRow = document.createElement('tr');
                categoryRow.className = 'category-header';
                categoryRow.innerHTML = `
                    <td colspan="4">${category.charAt(0).toUpperCase() + category.slice(1)} Items</td>
                `;
                tbody.appendChild(categoryRow);

                // Items in category
                items.forEach(item => {
                    const row = document.createElement('tr');
                    const unitPrice = item.materialCost + item.laborCost;
                    const totalPrice = unitPrice * item.quantity;
                    
                    row.innerHTML = `
                        <td>${item.description}</td>
                        <td>${item.quantity} ${item.unit}</td>
                        <td>${formatCurrency(unitPrice)}</td>
                        <td>${formatCurrency(totalPrice)}</td>
                    `;
                    tbody.appendChild(row);
                });
            });

            // Update totals in quote
            const subtotal = projectItems.reduce((sum, item) => {
                return sum + ((item.materialCost + item.laborCost) * item.quantity);
            }, 0);

            const discountPercent = parseFloat(document.getElementById('discountPercent').value) || 0;
            const taxPercent = parseFloat(document.getElementById('taxPercent').value) || 0;

            const discountAmount = subtotal * (discountPercent / 100);
            const afterDiscount = subtotal - discountAmount;
            const taxAmount = afterDiscount * (taxPercent / 100);
            const grandTotal = afterDiscount + taxAmount;

            document.getElementById('quoteSubtotal').textContent = formatCurrency(subtotal);
            document.getElementById('quoteDiscountPercent').textContent = discountPercent;
            document.getElementById('quoteDiscount').textContent = formatCurrency(discountAmount);
            document.getElementById('quoteTaxPercent').textContent = taxPercent;
            document.getElementById('quoteTax').textContent = formatCurrency(taxAmount);
            document.getElementById('quoteGrandTotal').textContent = formatCurrency(grandTotal);

            // Update terms
            const defaultSettings = DataManager.load(STORAGE_KEYS.DEFAULT_SETTINGS, DEFAULT_SETTINGS);
            if (defaultSettings.terms) {
                const termsContainer = document.getElementById('quoteTerms');
                termsContainer.innerHTML = `<ul style="color: #4a5568; font-size: 14px; line-height: 1.6;">
                    ${defaultSettings.terms.split('\n').map(term => 
                        term.trim() ? `<li>${term.replace('‚Ä¢', '').trim()}</li>` : ''
                    ).join('')}
                </ul>`;
            }

            // Update quote date
            document.getElementById('quoteDate').textContent = new Date().toLocaleDateString();
        }

        function generateQuote() {
            if (!document.getElementById('customerName').value) {
                showNotification('Please enter customer name', 'error');
                return;
            }

            if (projectItems.length === 0) {
                showNotification('Please add at least one project item', 'error');
                return;
            }

            updateQuote();
            switchTab('quote');
            document.querySelector('[onclick="switchTab(\'quote\')"]').click();
            showNotification('‚úÖ Quote generated successfully!');
        }

        function saveQuote() {
            if (!document.getElementById('customerName').value) {
                showNotification('Please enter customer name', 'error');
                return;
            }

            const quote = {
                id: Date.now(),
                customerName: document.getElementById('customerName').value,
                customerPhone: document.getElementById('customerPhone').value,
                customerEmail: document.getElementById('customerEmail').value,
                propertyAddress: document.getElementById('propertyAddress').value,
                projectDescription: document.getElementById('projectDescription').value,
                projectDate: document.getElementById('projectDate').value,
                items: [...projectItems],
                discountPercent: parseFloat(document.getElementById('discountPercent').value) || 0,
                taxPercent: parseFloat(document.getElementById('taxPercent').value) || 0,
                createdDate: new Date().toISOString()
            };

            // Calculate total
            const subtotal = projectItems.reduce((sum, item) => {
                return sum + ((item.materialCost + item.laborCost) * item.quantity);
            }, 0);
            const discountAmount = subtotal * (quote.discountPercent / 100);
            const taxAmount = (subtotal - discountAmount) * (quote.taxPercent / 100);
            quote.total = subtotal - discountAmount + taxAmount;

            // Load existing quotes
            const savedQuotes = DataManager.load(STORAGE_KEYS.SAVED_QUOTES, []);
            savedQuotes.unshift(quote);

            if (DataManager.save(STORAGE_KEYS.SAVED_QUOTES, savedQuotes)) {
                showNotification('üíæ Quote saved successfully!');
            } else {
                showNotification('Failed to save quote', 'error');
            }
        }

        function displaySavedQuotes() {
            const container = document.getElementById('savedQuotes');
            const savedQuotes = DataManager.load(STORAGE_KEYS.SAVED_QUOTES, []);
            
            if (savedQuotes.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #718096;">
                        <div style="font-size: 48px; margin-bottom: 16px;">üìã</div>
                        <h3>No saved quotes yet</h3>
                        <p>Create and save your first renovation quote</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = savedQuotes.map(quote => `
                <div class="quote-card">
                    <div class="quote-card-header">
                        <div class="quote-card-title">${quote.customerName}</div>
                        <div class="quote-card-amount">${formatCurrency(quote.total)}</div>
                    </div>
                    <div class="quote-card-details">
                        ${quote.propertyAddress || 'No address'} ‚Ä¢ ${new Date(quote.createdDate).toLocaleDateString()}
                        <br>${quote.projectDescription || 'No description'}
                    </div>
                    <div class="quote-card-actions">
                        <button class="card-action-btn btn-primary" onclick="loadQuote(${quote.id})">Load</button>
                        <button class="card-action-btn btn-warning" onclick="printSavedQuote(${quote.id})">Print</button>
                        <button class="card-action-btn btn-secondary" onclick="deleteQuote(${quote.id})">Delete</button>
                    </div>
                </div>
            `).join('');
        }

        function loadQuote(id) {
            const savedQuotes = DataManager.load(STORAGE_KEYS.SAVED_QUOTES, []);
            const quote = savedQuotes.find(q => q.id === id);
            if (!quote) return;

            // Load customer data
            document.getElementById('customerName').value = quote.customerName || '';
            document.getElementById('customerPhone').value = quote.customerPhone || '';
            document.getElementById('customerEmail').value = quote.customerEmail || '';
            document.getElementById('propertyAddress').value = quote.propertyAddress || '';
            document.getElementById('projectDescription').value = quote.projectDescription || '';
            document.getElementById('projectDate').value = quote.projectDate || '';
            document.getElementById('discountPercent').value = quote.discountPercent || '';
            document.getElementById('taxPercent').value = quote.taxPercent || '';

            // Load items
            projectItems = [...quote.items];
            refreshItemsContainer();

            showNotification('üìã Quote loaded successfully!');
            switchTab('customer');
            document.querySelector('[onclick="switchTab(\'customer\')"]').click();
        }

        function deleteQuote(id) {
            if (confirm('Are you sure you want to delete this quote?')) {
                const savedQuotes = DataManager.load(STORAGE_KEYS.SAVED_QUOTES, []);
                const filteredQuotes = savedQuotes.filter(q => q.id !== id);
                
                if (DataManager.save(STORAGE_KEYS.SAVED_QUOTES, filteredQuotes)) {
                    displaySavedQuotes();
                    showNotification('üóëÔ∏è Quote deleted');
                } else {
                    showNotification('Failed to delete quote', 'error');
                }
            }
        }

        function printQuote() {
            window.print();
        }

        function printSavedQuote(id) {
            loadQuote(id);
            setTimeout(() => {
                generateQuote();
                setTimeout(() => {
                    window.print();
                }, 500);
            }, 500);
        }

        // Data management functions
        function exportData() {
            const allData = {
                companySettings: DataManager.load(STORAGE_KEYS.COMPANY_SETTINGS),
                defaultSettings: DataManager.load(STORAGE_KEYS.DEFAULT_SETTINGS),
                currentQuote: DataManager.load(STORAGE_KEYS.CURRENT_QUOTE),
                savedQuotes: DataManager.load(STORAGE_KEYS.SAVED_QUOTES),
                userPreferences: DataManager.load(STORAGE_KEYS.USER_PREFERENCES),
                exportDate: new Date().toISOString(),
                version: '2.0'
            };

            const dataStr = JSON.stringify(allData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `renovation-pro-backup-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);

            showNotification('üì§ Data exported successfully!');
        }

        function importData() {
            document.getElementById('importFile').click();
        }

        function handleImportFile(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const importedData = JSON.parse(e.target.result);
                    
                    if (confirm('This will replace all your current data. Are you sure you want to continue?')) {
                        // Import all data
                        if (importedData.companySettings) {
                            DataManager.save(STORAGE_KEYS.COMPANY_SETTINGS, importedData.companySettings);
                        }
                        if (importedData.defaultSettings) {
                            DataManager.save(STORAGE_KEYS.DEFAULT_SETTINGS, importedData.defaultSettings);
                        }
                        if (importedData.currentQuote) {
                            DataManager.save(STORAGE_KEYS.CURRENT_QUOTE, importedData.currentQuote);
                        }
                        if (importedData.savedQuotes) {
                            DataManager.save(STORAGE_KEYS.SAVED_QUOTES, importedData.savedQuotes);
                        }
                        if (importedData.userPreferences) {
                            DataManager.save(STORAGE_KEYS.USER_PREFERENCES, importedData.userPreferences);
                        }

                        showNotification('üì• Data imported successfully! Reloading...');
                        setTimeout(() => {
                            window.location.reload();
                        }, 1500);
                    }
                } catch (error) {
                    showNotification('Invalid file format', 'error');
                }
            };
            reader.readAsText(file);
            
            // Reset file input
            event.target.value = '';
        }

        function clearCurrentQuote() {
            if (confirm('Are you sure you want to clear the current quote?')) {
                DataManager.remove(STORAGE_KEYS.CURRENT_QUOTE);
                
                // Clear form
                document.getElementById('customerName').value = '';
                document.getElementById('customerPhone').value = '';
                document.getElementById('customerEmail').value = '';
                document.getElementById('propertyAddress').value = '';
                document.getElementById('projectDescription').value = '';
                document.getElementById('projectDate').value = new Date().toISOString().split('T')[0];
                document.getElementById('discountPercent').value = '';
                document.getElementById('taxPercent').value = '';
                
                // Clear items
                projectItems = [];
                refreshItemsContainer();
                addItem(); // Add one empty item
                
                showNotification('üóëÔ∏è Current quote cleared');
            }
        }

        function resetAllData() {
            if (confirm('‚ö†Ô∏è This will delete ALL your data including company settings, quotes, and preferences. This action cannot be undone. Are you sure?')) {
                if (confirm('üö® FINAL WARNING: This will permanently delete everything. Continue?')) {
                    DataManager.clear();
                    showNotification('‚ö†Ô∏è All data deleted. Reloading app...', 'warning');
                    setTimeout(() => {
                        window.location.reload();
                    }, 2000);
                }
            }
        }

        // Initialize app
        function initializeApp() {
            console.log('üèóÔ∏è Initializing Renovation Pro...');
            
            // Set today's date as default
            document.getElementById('projectDate').value = new Date().toISOString().split('T')[0];
            
            // Load persistent data
            loadCompanySettings();
            loadDefaultSettings();
            loadCurrentQuote();
            
            // Add initial item if none exist
            if (projectItems.length === 0) {
                addItem();
            }
            
            // Start auto-save
            startAutoSave();
            
            // Update calculations
            calculateTotals();
            
            // Set up event listeners for auto-save
            const formInputs = document.querySelectorAll('input, textarea, select');
            formInputs.forEach(input => {
                input.addEventListener('input', () => {
                    setTimeout(saveCurrentQuote, 1000); // Debounced auto-save
                });
            });
            
            showNotification('üèóÔ∏è Renovation Pro Ready with Persistent Storage!');
            DataManager.updateDataStatus('saved');
            
            console.log('‚úÖ App initialized successfully');
        }

        // Initialize when DOM is loaded
        document.addEventListener('DOMContentLoaded', initializeApp);

        // Handle page unload
        window.addEventListener('beforeunload', function(e) {
            saveCurrentQuote();
        });

        // Handle visibility change (mobile tab switching)
        document.addEventListener('visibilitychange', function() {
            if (document.visibilityState === 'hidden') {
                saveCurrentQuote();
            }
        });
    </script>
</body>
</html>
